!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.mbmap=e():t.mbmap=e()}(window,function(){return function(t){var e=window.webpackHotUpdate_name_;window.webpackHotUpdate_name_=function(t,r){!function(t,e){if(!_[t]||!b[t])return;for(var r in b[t]=!1,e)Object.prototype.hasOwnProperty.call(e,r)&&(g[r]=e[r]);0==--m&&0===v&&C()}(t,r),e&&e(t,r)};var r,n=!0,o="36c3b482d447ba59fae4",i=1e4,a={},s=[],u=[];function p(t){var e=x[t];if(!e)return E;var n=function(n){return e.hot.active?(x[n]?-1===x[n].parents.indexOf(t)&&x[n].parents.push(t):(s=[t],r=n),-1===e.children.indexOf(n)&&e.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+t),s=[]),E(n)},o=function(t){return{configurable:!0,enumerable:!0,get:function(){return E[t]},set:function(e){E[t]=e}}};for(var i in E)Object.prototype.hasOwnProperty.call(E,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(n,i,o(i));return n.e=function(t){return"ready"===h&&f("prepare"),v++,E.e(t).then(e,function(t){throw e(),t});function e(){v--,"prepare"===h&&(M[t]||w(t),0===v&&0===m&&C())}},n.t=function(t,e){return 1&e&&(t=n(t)),E.t(t,-2&e)},n}function l(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:r!==t,active:!0,accept:function(t,r){if(void 0===t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var n=0;n<t.length;n++)e._acceptedDependencies[t[n]]=r||function(){};else e._acceptedDependencies[t]=r||function(){}},decline:function(t){if(void 0===t)e._selfDeclined=!0;else if("object"==typeof t)for(var r=0;r<t.length;r++)e._declinedDependencies[t[r]]=!0;else e._declinedDependencies[t]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var r=e._disposeHandlers.indexOf(t);r>=0&&e._disposeHandlers.splice(r,1)},check:L,apply:S,status:function(t){if(!t)return h;c.push(t)},addStatusHandler:function(t){c.push(t)},removeStatusHandler:function(t){var e=c.indexOf(t);e>=0&&c.splice(e,1)},data:a[t]};return r=void 0,e}var c=[],h="idle";function f(t){h=t;for(var e=0;e<c.length;e++)c[e].call(null,t)}var d,g,y,m=0,v=0,M={},b={},_={};function P(t){return+t+""===t?+t:t}function L(t){if("idle"!==h)throw new Error("check() is only allowed in idle status");return n=t,f("check"),(e=i,e=e||1e4,new Promise(function(t,r){if("undefined"==typeof XMLHttpRequest)return r(new Error("No browser support"));try{var n=new XMLHttpRequest,i=E.p+""+o+".hot-update.json";n.open("GET",i,!0),n.timeout=e,n.send(null)}catch(t){return r(t)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)r(new Error("Manifest request to "+i+" timed out."));else if(404===n.status)t();else if(200!==n.status&&304!==n.status)r(new Error("Manifest request to "+i+" failed."));else{try{var e=JSON.parse(n.responseText)}catch(t){return void r(t)}t(e)}}})).then(function(t){if(!t)return f("idle"),null;b={},M={},_=t.c,y=t.h,f("prepare");var e=new Promise(function(t,e){d={resolve:t,reject:e}});g={};return w(5),"prepare"===h&&0===v&&0===m&&C(),e});var e}function w(t){_[t]?(b[t]=!0,m++,function(t){var e=document.createElement("script");e.charset="utf-8",e.src=E.p+""+t+"."+o+".hot-update.js",document.head.appendChild(e)}(t)):M[t]=!0}function C(){f("ready");var t=d;if(d=null,t)if(n)Promise.resolve().then(function(){return S(n)}).then(function(e){t.resolve(e)},function(e){t.reject(e)});else{var e=[];for(var r in g)Object.prototype.hasOwnProperty.call(g,r)&&e.push(P(r));t.resolve(e)}}function S(e){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var r,n,i,u,p;function l(t){for(var e=[t],r={},n=e.map(function(t){return{chain:[t],id:t}});n.length>0;){var o=n.pop(),i=o.id,a=o.chain;if((u=x[i])&&!u.hot._selfAccepted){if(u.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:i};if(u.hot._main)return{type:"unaccepted",chain:a,moduleId:i};for(var s=0;s<u.parents.length;s++){var p=u.parents[s],l=x[p];if(l){if(l.hot._declinedDependencies[i])return{type:"declined",chain:a.concat([p]),moduleId:i,parentId:p};-1===e.indexOf(p)&&(l.hot._acceptedDependencies[i]?(r[p]||(r[p]=[]),c(r[p],[i])):(delete r[p],e.push(p),n.push({chain:a.concat([p]),id:p})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:r}}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];-1===t.indexOf(n)&&t.push(n)}}e=e||{};var d={},m=[],v={},M=function(){console.warn("[HMR] unexpected require("+L.moduleId+") to disposed module")};for(var b in g)if(Object.prototype.hasOwnProperty.call(g,b)){var L;p=P(b);var w=!1,C=!1,S=!1,O="";switch((L=g[b]?l(p):{type:"disposed",moduleId:b}).chain&&(O="\nUpdate propagation: "+L.chain.join(" -> ")),L.type){case"self-declined":e.onDeclined&&e.onDeclined(L),e.ignoreDeclined||(w=new Error("Aborted because of self decline: "+L.moduleId+O));break;case"declined":e.onDeclined&&e.onDeclined(L),e.ignoreDeclined||(w=new Error("Aborted because of declined dependency: "+L.moduleId+" in "+L.parentId+O));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(L),e.ignoreUnaccepted||(w=new Error("Aborted because "+p+" is not accepted"+O));break;case"accepted":e.onAccepted&&e.onAccepted(L),C=!0;break;case"disposed":e.onDisposed&&e.onDisposed(L),S=!0;break;default:throw new Error("Unexception type "+L.type)}if(w)return f("abort"),Promise.reject(w);if(C)for(p in v[p]=g[p],c(m,L.outdatedModules),L.outdatedDependencies)Object.prototype.hasOwnProperty.call(L.outdatedDependencies,p)&&(d[p]||(d[p]=[]),c(d[p],L.outdatedDependencies[p]));S&&(c(m,[L.moduleId]),v[p]=M)}var k,T=[];for(n=0;n<m.length;n++)p=m[n],x[p]&&x[p].hot._selfAccepted&&v[p]!==M&&T.push({module:p,errorHandler:x[p].hot._selfAccepted});f("dispose"),Object.keys(_).forEach(function(t){!1===_[t]&&function(t){delete installedChunks[t]}(t)});for(var F,j,I=m.slice();I.length>0;)if(p=I.pop(),u=x[p]){var A={},D=u.hot._disposeHandlers;for(i=0;i<D.length;i++)(r=D[i])(A);for(a[p]=A,u.hot.active=!1,delete x[p],delete d[p],i=0;i<u.children.length;i++){var R=x[u.children[i]];R&&((k=R.parents.indexOf(p))>=0&&R.parents.splice(k,1))}}for(p in d)if(Object.prototype.hasOwnProperty.call(d,p)&&(u=x[p]))for(j=d[p],i=0;i<j.length;i++)F=j[i],(k=u.children.indexOf(F))>=0&&u.children.splice(k,1);for(p in f("apply"),o=y,v)Object.prototype.hasOwnProperty.call(v,p)&&(t[p]=v[p]);var B=null;for(p in d)if(Object.prototype.hasOwnProperty.call(d,p)&&(u=x[p])){j=d[p];var U=[];for(n=0;n<j.length;n++)if(F=j[n],r=u.hot._acceptedDependencies[F]){if(-1!==U.indexOf(r))continue;U.push(r)}for(n=0;n<U.length;n++){r=U[n];try{r(j)}catch(t){e.onErrored&&e.onErrored({type:"accept-errored",moduleId:p,dependencyId:j[n],error:t}),e.ignoreErrored||B||(B=t)}}}for(n=0;n<T.length;n++){var N=T[n];p=N.module,s=[p];try{E(p)}catch(t){if("function"==typeof N.errorHandler)try{N.errorHandler(t)}catch(r){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:p,error:r,originalError:t}),e.ignoreErrored||B||(B=r),B||(B=t)}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:p,error:t}),e.ignoreErrored||B||(B=t)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise(function(t){t(m)}))}var x={};function E(e){if(x[e])return x[e].exports;var r=x[e]={i:e,l:!1,exports:{},hot:l(e),parents:(u=s,s=[],u),children:[]};return t[e].call(r.exports,r,r.exports,p(e)),r.l=!0,r.exports}return E.m=t,E.c=x,E.d=function(t,e,r){E.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},E.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},E.t=function(t,e){if(1&e&&(t=E(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(E.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)E.d(r,n,function(e){return t[e]}.bind(null,n));return r},E.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return E.d(e,"a",e),e},E.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},E.p="",E.h=function(){return o},p("F0BF")(E.s="F0BF")}({"+jW5":function(t,e,r){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||o,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function o(t,e){return t<e?-1:t>e?1:0}t.exports=n,t.exports.default=n,n.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,r=this.compare,n=e[t];t>0;){var o=t-1>>1,i=e[o];if(r(n,i)>=0)break;e[t]=i,t=o}e[t]=n},_down:function(t){for(var e=this.data,r=this.compare,n=this.length>>1,o=e[t];t<n;){var i=1+(t<<1),a=i+1,s=e[i];if(a<this.length&&r(e[a],s)<0&&(i=a,s=e[a]),r(s,o)>=0)break;e[t]=s,t=i}e[t]=o}}},"/rf6":function(t,e,r){"use strict";function n(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function o(t,e,r){return void 0===r&&(r={}),n({type:"Point",coordinates:t},e,r)}function i(t,e,r){void 0===r&&(r={});for(var o=0,i=t;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,r)}function a(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,r)}function s(t,e){void 0===e&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function u(t,e,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:t},e,r)}function p(t,e,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:t},e,r)}function l(t,e,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:t},e,r)}function c(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t*n}function h(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t/n}function f(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,r){switch(void 0===r&&(r={}),t){case"Point":return o(e).geometry;case"LineString":return a(e).geometry;case"Polygon":return i(e).geometry;case"MultiPoint":return p(e).geometry;case"MultiLineString":return u(e).geometry;case"MultiPolygon":return l(e).geometry;default:throw new Error(t+" is invalid")}},e.point=o,e.points=function(t,e,r){return void 0===r&&(r={}),s(t.map(function(t){return o(t,e)}),r)},e.polygon=i,e.polygons=function(t,e,r){return void 0===r&&(r={}),s(t.map(function(t){return i(t,e)}),r)},e.lineString=a,e.lineStrings=function(t,e,r){return void 0===r&&(r={}),s(t.map(function(t){return a(t,e)}),r)},e.featureCollection=s,e.multiLineString=u,e.multiPoint=p,e.multiPolygon=l,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,e||0);return Math.round(t*r)/r},e.radiansToLength=c,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return f(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=f,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(h(t,e),r)},e.convertArea=function(t,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var o=e.areaFactors[r];if(!o)throw new Error("invalid original units");var i=e.areaFactors[n];if(!i)throw new Error("invalid final units");return t/o*i},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")},e.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},e.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},e.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},e.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},e.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},e.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},e.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},"0+U7":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){var t=this;this.draw.start("line",function(e){null!=e&&(""===t.fid?(t.fid=e.id,e.properties.$type="LineString",t.source.add(e)):(e.id=t.fid,t.source.edit(e),t.draw.clear()))},function(e){null!=e&&(e.id=t.fid,t.source.edit(e))})},e}(r("34Jj").Base);e.LineString=i},"0b1U":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=t+e,o=n-t,i=e-o,a=t-(n-o);if(r)return r[0]=a+i,r[1]=n,r;return[a+i,n]}},"19Z0":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("tN60"),o=function(){function t(t){this.uuid="",this.data=null,this.color="#ff0000",this.end=null,this.popup=null,this.markers=[],this._onMouseMove=null,this._onMouseClick=null,this._onMouseDblClick=null,this.fristPoint=[],this.lastPoint=[],this.pointArr=[],this.type=0,this.map=t,this._onMouseMove=this.onMouseMove.bind(this),this._onMouseClick=this.onMouseClick.bind(this),this._onMouseDblClick=this.onMouseDblClick.bind(this)}return t.prototype.lineMeasure=function(){this.type=1,this.startMeasure()},t.prototype.areaMeasure=function(){this.type=2,this.startMeasure()},t.prototype.clear=function(){this.endMeasure(),this.markers.forEach(function(t){t.remove()}),null!=this.popup&&this.popup.remove(),this.markers=[],this.fristPoint=[];var t=this.map.getMap();t.getLayer("rangingLayerLine1_"+this.uuid)&&t.removeLayer("rangingLayerLine1_"+this.uuid),t.getLayer("rangingLayerLine2_"+this.uuid)&&t.removeLayer("rangingLayerLine2_"+this.uuid),t.getLayer("rangingLayerCircle1_"+this.uuid)&&t.removeLayer("rangingLayerCircle1_"+this.uuid),t.getLayer("rangingLayerCircle2_"+this.uuid)&&t.removeLayer("rangingLayerCircle2_"+this.uuid),t.getLayer("rangingLayerFill_"+this.uuid)&&t.removeLayer("rangingLayerFill_"+this.uuid),t.getSource("rangingSource_"+this.uuid)&&t.removeSource("rangingSource_"+this.uuid),t.getSource("rangingSource2_"+this.uuid)&&t.removeSource("rangingSource2_"+this.uuid)},t.prototype.initRangingSource=function(t,e){var r=this.map.getMap();if(!r.getSource("rangingSource_"+this.uuid)){var n={type:"geojson",data:t};r.addSource("rangingSource_"+this.uuid,n)}if(!r.getSource("rangingSource2_"+this.uuid)){var o={type:"geojson",data:e};r.addSource("rangingSource2_"+this.uuid,o)}},t.prototype.initRangingLayer=function(){var t=this.map.getMap();t.addLayer({id:"rangingLayerLine1_"+this.uuid,source:"rangingSource_"+this.uuid,type:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":this.color,"line-width":3},filter:["all",["==","type","line"],["==","mark",1]]}),t.addLayer({id:"rangingLayerLine2_"+this.uuid,source:"rangingSource_"+this.uuid,type:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":this.color,"line-width":3,"line-dasharray":[2,2]},filter:["all",["==","type","line"],["==","mark",2]]}),t.addLayer({id:"rangingLayerFill_"+this.uuid,type:"fill",source:"rangingSource2_"+this.uuid,paint:{"fill-color":this.color,"fill-opacity":.5}}),t.addLayer({id:"rangingLayerCircle1_"+this.uuid,source:"rangingSource_"+this.uuid,type:"circle",paint:{"circle-radius":6,"circle-color":this.color},filter:["==","type","point"]}),t.addLayer({id:"rangingLayerCircle2_"+this.uuid,source:"rangingSource_"+this.uuid,type:"circle",paint:{"circle-radius":4,"circle-color":"#ffffff"},filter:["==","type","point"]})},t.prototype.onMouseMove=function(t){var e=this;if(!(this.data.features.length<1)){var r=t.lngLat,o=Number.parseFloat(r.lng),i=Number.parseFloat(r.lat),a=this.lastPoint,s=!1,u=null;if(this.data.features.forEach(function(t){1===t.properties.mark&&"line"===t.properties.type&&(u=e.Clone(t)).geometry.coordinates.push([o,i]),2===t.properties.mark&&"line"===t.properties.type&&(t.geometry.coordinates=[a,[o,i]],s=!0)}),!s){var p={type:"Feature",geometry:{type:"LineString",coordinates:[[o,i]]},properties:{mark:2,type:"line"}};this.data.features.push(p)}this.pointArr.push([o,i]);var l=this.map.getMap();if(l.getSource("rangingSource_"+this.uuid)?l.getSource("rangingSource_"+this.uuid).setData(this.data):(this.initRangingSource(this.data,{type:"FeatureCollection",features:[]}),this.initRangingLayer()),1===this.type){var c=Math.round(100*n.TurfUtils.turfLength(u))/100,h='<span>总长</span><span style="color:#ff6319">';h+=c>=1?Math.round(100*c)/100+"</span><span>千米":Math.round(1e5*c)/100+"</span><span>米",h+="</span><br/><span>单击确定起点,双击结束</span>",this.popup.setLngLat([o,i]).setHTML(h)}else{this.pointArr.push(this.fristPoint);var f={type:"Feature",geometry:{type:"Polygon",coordinates:[this.pointArr]},properties:{}};l.getSource("rangingSource2_"+this.uuid).setData(f);var d=Math.round(100*n.TurfUtils.turfArea(f))/100;h="";d>0&&(h+='<span>面积</span><span style="color:#ff6319">',h+=d<1e5?d+"</span><span>平方米":Math.round(d/1e6*100)/100+"</span><span>平方千米",h+="</span><br/>"),h+="<span>单击确定起点,双击结束</span>",this.popup.setLngLat([o,i]).setHTML(h),this.pointArr.pop()}this.pointArr.pop()}},t.prototype.onMouseClick=function(t){var e=t.lngLat,r=Number.parseFloat(e.lng),o=Number.parseFloat(e.lat),i=!0,a=null,s=0;this.data.features.forEach(function(t){1===t.properties.mark&&"line"===t.properties.type&&(t.geometry.coordinates.push([r,o]),a=t,i=!1),"point"===t.properties.type&&s++});var u=s+1,p={type:"Feature",geometry:{type:"Point",coordinates:[r,o]},properties:{mark:u,type:"point"}};this.data.features.push(p),this.pointArr.push([r,o]),i&&(a={type:"Feature",geometry:{type:"LineString",coordinates:[[r,o]]},properties:{mark:1,type:"line"}},this.data.features.push(a),this.fristPoint=[r,o]),this.lastPoint=[r,o];var l=this.map.getMap();if(l.getSource("rangingSource_"+this.uuid)?l.getSource("rangingSource_"+this.uuid).setData(this.data):(this.initRangingSource(this.data,{type:"FeatureCollection",features:[]}),this.initRangingLayer()),1===this.type){var c=0;if(u>=1){c=Math.round(100*n.TurfUtils.turfLength(a))/100;var h=this.getMarker(c,[r,o],u);this.markers.push(h)}}else this.pointArr.push(this.fristPoint),l.getSource("rangingSource2_"+this.uuid).setData({type:"Feature",geometry:{type:"Polygon",coordinates:[this.pointArr]},properties:{}}),this.pointArr.pop()},t.prototype.onMouseDblClick=function(t){var e=this,r=t.lngLat,o=Number.parseFloat(r.lng),i=Number.parseFloat(r.lat),a=0,s=null;this.data.features.forEach(function(t){1===t.properties.mark&&"line"===t.properties.type&&(1===e.type?t.geometry.coordinates.push([o,i]):e.fristPoint&&e.fristPoint[0]!==o&&e.fristPoint[1]!==i?t.geometry.coordinates.push([o,i],e.fristPoint):t.geometry.coordinates.push([o,i]),s=t),"point"===t.properties.type&&a++});var u={type:"Feature",geometry:{type:"Point",coordinates:[o,i]},properties:{mark:a+1,type:"point"}};this.data.features.push(u),this.pointArr.push([o,i]),this.lastPoint=[o,i];var p=this.map.getMap();if(p.getSource("rangingSource_"+this.uuid)?p.getSource("rangingSource_"+this.uuid).setData(this.data):(this.initRangingSource(this.data,{type:"FeatureCollection",features:[]}),this.initRangingLayer()),1===this.type){if(s){var l=Math.round(100*n.TurfUtils.turfLength(s))/100,c=this.getEndMarker(l,[o,i]);this.markers.push(c)}}else{this.pointArr.push(this.fristPoint);var h={type:"Feature",geometry:{type:"Polygon",coordinates:[this.pointArr]},properties:{}};p.getSource("rangingSource2_"+this.uuid).setData(h);var f=Math.round(100*n.TurfUtils.turfArea(h))/100;c=this.getEndMarker(f,[o,i]);this.markers.push(c),this.pointArr.pop()}this.endMeasure()},t.prototype.startMeasure=function(){this.clear(),this.uuid=this.getUuid();var t=this.map.getMap();t.getCanvas().style.cursor="crosshair",t.on("mousemove",this._onMouseMove),t.on("click",this._onMouseClick),t.on("dblclick",this._onMouseDblClick),this.data={type:"FeatureCollection",features:[]},this.pointArr=[],this.initRangingSource(this.data,this.data),this.initRangingLayer(),this.popup=new mapboxgl.Popup({closeOnClick:!1,closeButton:!1,anchor:"left",offset:[20,20]}).addTo(t),t.doubleClickZoom.disable()},t.prototype.endMeasure=function(){var t=this.map.getMap();t.off("mousemove",this._onMouseMove),t.off("click",this._onMouseClick),t.off("dblclick",this._onMouseDblClick),t.getCanvas().style.cursor="",null!=this.popup&&this.popup.remove(),t.doubleClickZoom.enable()},t.prototype.getMarker=function(t,e,r){var n="<span>起点</span>";r>1&&(n=t>=1?t+"</span><span>千米</span>":Math.round(1e5*t)/100+"</span><span>米</span>");var o=document.createElement("div");o.className="minemap-marker-ranging-label",o.style.borderRadius="2px",o.style.fontSize="12px",o.style.lineHeight="20px",o.style.background="#ffffff",o.style.border="1px solid #7a7a7a",o.style.paddingLeft="2px",o.style.paddingRight="7px",o.style.whiteSpace="nowrap",o.style.cursor="default",o.style.wordWrap="break-word",o.style.color="#565656",o.style.userSelect="none",o.style.display="inline-block",o.style.verticalAlign="middle";var i=document.createElement("span");return i.className="ranging-info",i.style.marginLeft="5px",i.innerHTML=n,o.appendChild(i),new mapboxgl.Marker(o,{offset:[7,-11]}).setLngLat(e).addTo(this.map.getMap())},t.prototype.getEndMarker=function(t,e){var r="<span>"+(1===this.type?"总长":"总面积")+'</span><span style="color:#ff6319">';2===this.type?r+=t>=1e4?Math.round(t/1e6*100)/100+" </span><span>平方千米</span>":t+"</span><span>平方米</span>":r+=t>1?Math.round(100*t)/100+" </span><span>千米</span>":Math.round(1e5*t)/100+" </span><span>米</span>";var n=document.createElement("div");n.className="minemap-marker-ranging-endLabel",n.style.borderRadius="2px",n.style.fontSize="12px",n.style.lineHeight="20px",n.style.background="#ffffff",n.style.border="1px solid #7a7a7a",n.style.paddingLeft="2px",n.style.paddingRight="7px",n.style.whiteSpace="nowrap",n.style.cursor="default",n.style.wordWrap="break-word",n.style.color="#565656",n.style.userSelect="none",n.style.display="inline-block",n.style.verticalAlign="middle";var o=document.createElement("span");o.className="ranging-info",o.innerHTML=r;var i=document.createElement("span");return i.className="ranging-btn glyphicon glyphicon-trash",i.style.marginLeft="5px",i.style.color="#ff0000",i.style.cursor="pointer",i.title=1===this.type?"清除本次测距":"清除本次测面",i.innerHTML=1===this.type?"清除测距":"清除面积",i.addEventListener("click",this.clear.bind(this)),n.appendChild(o),n.appendChild(i),new mapboxgl.Marker(n,{offset:[7,-11]}).setLngLat(e).addTo(this.map.getMap())},t.prototype.getUuid=function(){for(var t=[],e=0;e<32;e++)t[e]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t.join("")},t.prototype.Clone=function(t){if(null==t||{}==t||[]==t)return t;var e,r=!1;t.length?(e=[],r=!0):(e={},r=!1);for(var n=0,o=Object.keys(t);n<o.length;n++){var i=o[n];if(null==t[i])r?e.push(null):e[i]=null;else{var a="object"==typeof t[i]?this.Clone(t[i]):t[i];r?e.push(a):e[i]=a}}return e},t}();e.MbMeasure=o},"1Ccr":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.emptyFeatures={type:"FeatureCollection",features:[]},this.features=[]}return t.prototype.init=function(t){this.pmap=t,this.pmap.getMap().addSource("PLOTTING_SOURCE_ID",{data:this.emptyFeatures,type:"geojson"}),this.addPolygonLayer(),this.addLineLayer(),this.addPointLayer()},t.prototype.addPointLayer=function(){this.pmap.getMap().addLayer({id:"gl-plotting-point-inactive",type:"circle",filter:["all",["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#3bb2d0"},source:"PLOTTING_SOURCE_ID"})},t.prototype.addLineLayer=function(){this.pmap.getMap().addLayer({id:"gl-plotting-line-inactive",type:"line",filter:["all",["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2},source:"PLOTTING_SOURCE_ID"})},t.prototype.addPolygonLayer=function(){var t=this.pmap.getMap();t.addLayer({id:"gl-plotting-polygon-fill-inactive",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1},source:"PLOTTING_SOURCE_ID"}),t.addLayer({id:"gl-plotting-polygon-stroke-inactive",type:"line",filter:["all",["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2},source:"PLOTTING_SOURCE_ID"})},t.prototype.draw=function(){var t={type:"FeatureCollection",features:this.features};this.pmap.getMap().getSource("PLOTTING_SOURCE_ID").setData(t)},t.prototype.clear=function(){this.pmap.getMap().getSource("PLOTTING_SOURCE_ID").setData(this.emptyFeatures)},t.prototype.add=function(t){this.features.push(t),this.draw()},t.prototype.edit=function(t){for(var e=0;e<this.features.length;e++){var r=this.features[e];if(r.id===t.id){r.geometry=t.geometry,r.properties=t.properties;break}}this.draw()},t.layers=["gl-plotting-point-inactive","gl-plotting-line-inactive","gl-plotting-polygon-fill-inactive","gl-plotting-polygon-stroke-inactive"],t}();e.PlottingSource=n},"1Dt2":function(t,e){},"1xm4":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){if(this._length=0,this._items={},this._nums={},this._length=t?t.length:0,t)for(var e=0,r=t.length;e<r;e++)this.add(t[e]),void 0!==t[e]&&("string"==typeof t[e]?this._items[t[e]]=e:this._nums[t[e]]=e)}return t.prototype.add=function(t){return this.has(t)?this:(this._length++,"string"==typeof t?this._items[t]=this._length:this._nums[t]=this._length,this)},t.prototype.delete=function(t){return!1===this.has(t)?this:(this._length--,delete this._items[t],delete this._nums[t],this)},t.prototype.has=function(t){return("string"==typeof t||"number"==typeof t)&&(void 0!==this._items[t]||void 0!==this._nums[t])},t.prototype.values=function(){var t=this,e=[];return Object.keys(this._items).forEach(function(r){e.push({k:r,v:t._items[r]})}),Object.keys(this._nums).forEach(function(r){e.push({k:JSON.parse(r),v:t._nums[r]})}),e.sort(function(t,e){return t.v-e.v}).map(function(t){return t.k})},t.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this},t}();e.StringSet=n},"2b6V":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){var t=this;this.draw.start("point",function(e){null!=e&&(""===t.fid?(t.fid=e.id,e.properties.$type="Point",t.source.add(e)):(e.id=t.fid,t.source.edit(e),t.draw.clear()))},function(e){null!=e&&(e.id=t.fid,t.source.edit(e))})},e}(r("34Jj").Base);e.Point=i},"34Jj":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.draw=map.Factory.Draw(),this.source=t,this.fid=e}return t.prototype.geoJsonOption=function(t){return t},t.prototype.start=function(){},t.prototype.complete=function(){this.draw.end(!0),this.draw.clear()},t.prototype.cancel=function(){this.draw.end(),this.draw.clear()},t}();e.Base=n},"34V/":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.getLayers=function(t,e){var r=map.Config.BaseUrl+"/styles/layers/"+map.Config.solution;map.Http.post(r,{browser:"1",terminal:"1",memory:1024,kernel:"mapbox"},t,e)},t}();e.DataUtils=n},"3wa9":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.enable=function(t){setTimeout(function(){t.getMap().doubleClickZoom.enable()},0)},t.disable=function(t){setTimeout(function(){t.getMap().doubleClickZoom.disable()},0)},t}();e.DoubleClickZoom=n},"4QC1":function(t,e,r){"use strict";t.exports=function(t,e){var r=0|t.length,n=0|e.length;if(1===r&&1===n)return function(t,e){var r=t+e,n=r-t,o=t-(r-n)+(e-n);if(o)return[o,r];return[r]}(t[0],-e[0]);var o,i,a=new Array(r+n),s=0,u=0,p=0,l=Math.abs,c=t[u],h=l(c),f=-e[p],d=l(f);h<d?(i=c,(u+=1)<r&&(c=t[u],h=l(c))):(i=f,(p+=1)<n&&(f=-e[p],d=l(f)));u<r&&h<d||p>=n?(o=c,(u+=1)<r&&(c=t[u],h=l(c))):(o=f,(p+=1)<n&&(f=-e[p],d=l(f)));var g,y,m=o+i,v=m-o,M=i-v,b=M,_=m;for(;u<r&&p<n;)h<d?(o=c,(u+=1)<r&&(c=t[u],h=l(c))):(o=f,(p+=1)<n&&(f=-e[p],d=l(f))),(M=(i=b)-(v=(m=o+i)-o))&&(a[s++]=M),b=_-((g=_+m)-(y=g-_))+(m-y),_=g;for(;u<r;)(M=(i=b)-(v=(m=(o=c)+i)-o))&&(a[s++]=M),b=_-((g=_+m)-(y=g-_))+(m-y),_=g,(u+=1)<r&&(c=t[u]);for(;p<n;)(M=(i=b)-(v=(m=(o=f)+i)-o))&&(a[s++]=M),b=_-((g=_+m)-(y=g-_))+(m-y),_=g,(p+=1)<n&&(f=-e[p]);b&&(a[s++]=b);_&&(a[s++]=_);s||(a[s++]=0);return a.length=s,a}},"58cj":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=r("o0BB"),a=r("NC79"),s=r("vbmK"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pointListForPolygon=[],e}return o(e,t),e.prototype.getType=function(){return"draw_polygon"},e.prototype.addPointAndDraw=function(e){t.prototype.addPointAndDraw.call(this,e),this.pointListForPolygon.length<2?(this.pointListForPolygon.push(e),this.pointListForLine.push(e),this.source.drawLine(this.pointListForLine)):2==this.pointListForPolygon.length?(this.pointListForPolygon.push(e),this.pointListForPolygon.push(this.pointListForPolygon[0]),this.source.clearLine(),this.source.drawPolygon(this.pointListForPolygon)):(this.pointListForPolygon.pop(),this.pointListForPolygon.push(e),this.pointListForPolygon.push(this.pointListForPolygon[0]),this.source.clearLine(),this.source.drawPolygon(this.pointListForPolygon))},e.prototype.delPoint=function(){if(this.drawing){if(t.prototype.delPoint.call(this),this.pointListForPolygon.length<=2)this.pointListForPolygon.pop();else{var e=this.pointListForPolygon.pop();this.pointListForPolygon.pop(),this.pointListForPolygon.push(e),3==this.pointListForPolygon.length&&this.pointListForPolygon.pop()}if(this.pointListForPolygon.length<=2){this.pointListForLine=[];for(var r=0;r<this.pointListForPolygon.length;r++)this.pointListForLine.push(this.pointListForPolygon[r]);this.source.clearLine(),this.source.drawLine(this.pointListForLine)}else this.source.clearLine(),this.source.drawPolygon(this.pointListForPolygon)}},e.prototype.getGeometry=function(){return this.pointListForPolygon.length<=2?null:new i.Polygon([this.pointListForPolygon])},e.prototype.editStart=function(){t.prototype.editStart.call(this)},e.prototype.updateGeometry=function(){t.prototype.updateGeometry.call(this),this.pointListForLine=[],this.pointListForPolygon=[];for(var e=0;e<this.pointList.length;e++){var r=this.pointList[e];"vertex"===r.properties.meta&&(this.pointListForLine.push(r.geometry.coordinates),this.pointListForPolygon.push(r.geometry.coordinates))}this.pointListForPolygon.length<=2?this.source.drawLine(this.pointListForLine):(this.pointListForPolygon.push(this.pointListForPolygon[0]),this.source.clearLine(),this.source.drawPolygon(this.pointListForPolygon))},e.prototype.getPoints=function(t){var e=[];return t[0].forEach(function(t){var r=new s.Point(t);r.setProperty("meta","vertex"),r.setProperty("active",!1),e.push(r)}),e},e}(a.DrawLineString);e.DrawPolygon=u},"5XcQ":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.getPointBoundingBox=function(t){for(var e,r,n=[360,180,0,0],o=0;o<t.length;o++)t[0]instanceof Array?(r=t[o][0],e=t[o][1],n[0]=n[0]<r?n[0]:r,n[1]=n[1]<e?n[1]:e,n[2]=n[2]>r?n[2]:r,n[3]=n[3]>e?n[3]:e):(n[0]=t[0],n[1]=t[1],n[2]=t[0],n[3]=t[1]);return n},t.getPolygonBoundingBox=function(t){for(var e,r=[360,180,0,0],n=0;n<t.length;n++){e=1===t.length?t[0][0][0]instanceof Array?t[0]:t:t[n];for(var o=0;o<e.length;o++){var i=this.getLineBoundingBox(e[o]);r=this.getMaxBounds(r,i)}}return r},t.getLineBoundingBox=function(t){for(var e,r=[360,180,0,0],n=0;n<t.length;n++){e=t[0][0]instanceof Array?t[n]:t;for(var o=0;o<e.length;o++){var i=this.getPointBoundingBox(e[o]);r=this.getMaxBounds(r,i)}}return r},t.getGeojsonBoundingBox=function(t){var e=[360,180,0,0];if(t)if("FeatureCollection"==t.type)for(var r=0;r<t.features.length;r++){var n=this.getGeojsonBoundingBox(t.features[r]);e=this.getMaxBounds(e,n)}else if("Feature"==t.type)switch(t.geometry.type){case"Point":case"MultiPoint":e=this.getPointBoundingBox(t.geometry.coordinates);break;case"LineString":case"MultiLineString":e=this.getLineBoundingBox(t.geometry.coordinates);break;case"Polygon":case"MultiPolygon":e=this.getPolygonBoundingBox(t.geometry.coordinates)}else if("GeometryCollection"==t.type)for(r=0;r<t.geometries.length;r++){n=[360,180,0,0];switch(t.geometries[r].type){case"Point":case"MultiPoint":n=this.getPointBoundingBox(t.geometries[r].coordinates);break;case"LineString":case"MultiLineString":n=this.getLineBoundingBox(t.geometries[r].coordinates);break;case"Polygon":case"MultiPolygon":n=this.getPolygonBoundingBox(t.geometries[r].coordinates)}e=this.getMaxBounds(e,n)}return e},t.getGeometryBoundingBox=function(t){var e=[360,180,0,0];if(t)switch(t.type){case"Point":case"MultiPoint":e=this.getPointBoundingBox(t.coordinates);break;case"LineString":case"MultiLineString":e=this.getLineBoundingBox(t.coordinates);break;case"Polygon":case"MultiPolygon":e=this.getPolygonBoundingBox(t.coordinates)}return e},t.getMaxBounds=function(t,e){var r=[0,0,0,0];return r[0]=t[0]<e[0]?t[0]:e[0],r[1]=t[1]<e[1]?t[1]:e[1],r[2]=t[2]>e[2]?t[2]:e[2],r[3]=t[3]>e[3]?t[3]:e[3],r},t}();e.GeojsonUtils=n},"74pp":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("3wa9"),o=function(){function t(){this.source=null,this.drawing=!1,this.click=null,this.dbclick=null,this.mousemove=null,this.mousedown=null,this.mouseup=null,this.onFinish=null,this.onEditing=null}return t.prototype.init=function(t,e){this.pmap=t,this.source=e},t.prototype.getType=function(){return""},t.prototype.start=function(t,e){this.clear(),this.end(!1);var r=this.pmap.getMap(),o=this;this.click=function(t){o.addPoint(t.lngLat)},r.on("click",this.click),this.dbclick=function(t){o.delPoint(),o.end(!0),o.editStart()},r.on("dblclick",this.dbclick),n.DoubleClickZoom.disable(this.pmap),this.drawing=!0,this.onFinish=t,this.onEditing=e},t.prototype.editStart=function(){n.DoubleClickZoom.disable(this.pmap)},t.prototype.addPoint=function(t){if(this.drawing){var e=[t.lng,t.lat];this.addPointAndDraw(e),"draw_point"===this.getType()&&(this.end(!0),this.editStart())}},t.prototype.addPointAndDraw=function(t){},t.prototype.delPoint=function(){},t.prototype.end=function(t){var e=this.pmap.getMap();null!=this.click&&e.off("click",this.click),null!=this.dbclick&&e.off("dblclick",this.dbclick),null!=this.mousemove&&e.off("mousemove",this.mousemove),null!=this.mousedown&&e.off("mousedown",this.mousedown),null!=this.mouseup&&e.off("mouseup",this.mouseup),n.DoubleClickZoom.enable(this.pmap),t&&this.onFinish&&this.onFinish(this.getGeometry()),this.drawing=!1},t.prototype.clear=function(){this.source.clear()},t.prototype.hasGeometry=function(){return!1},t.prototype.getDarwing=function(){return this.drawing},t.prototype.getGeometry=function(){return this.drawing,null},t.prototype.setPoints=function(t){},t}();e.ModeInterface=o},"8SP6":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=r("vbmK"),a=r("nZZu"),s=r("74pp"),u=r("e+jV"),p=r("BWdv"),l=r("EfW4"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pointList=[],e.canDragMove=!1,e}return o(e,t),e.prototype.getType=function(){return"draw_point"},e.prototype.addPointAndDraw=function(t){var e=new i.Point(t);e.setProperty("meta","vertex"),e.setProperty("active",!1),this.pointList.push(e),this.source.drawPoint(this.pointList)},e.prototype.delPoint=function(){this.drawing&&(this.pointList.length>0&&this.pointList.pop(),this.source.drawPoint(this.pointList))},e.prototype.hasGeometry=function(){return this.pointList.length>0},e.prototype.getGeometry=function(){return this.pointList.length>0?this.pointList[0]:null},e.prototype.editStart=function(){t.prototype.editStart.call(this);var e=this.pmap.getMap(),r=this;this.mousedown=function(t){r.canDragMove=!1,u.CreateVertex.clearHit(r.pointList);var n=a.FeaturesAt.at(e,t,6,null);if(null==n||n.length<=0)return r.pointList=p.CreateMidpoint.clear(r.pointList),void r.source.drawPoint(r.pointList);var o=n[0];"Point"===o.geometry.type?"vertex"===o.properties.meta?u.CreateVertex.hit(r.pointList,o):(p.CreateMidpoint.hit(r.pointList,o),r.pointList=p.CreateMidpoint.clear(r.pointList),r.pointList=p.CreateMidpoint.create(e,r.pointList),r.updateGeometry()):r.pointList=p.CreateMidpoint.create(e,r.pointList),r.source.drawPoint(r.pointList),r.dragObject=o,r.canDragMove=!0,r.dragMoveLocation=t.lngLat},e.on("mousedown",this.mousedown),this.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which)&&r.canDragMove){e.dragPan.disable();var n=r.dragObject;return"Point"===n.geometry.type?r.dragVertex(n,t):r.dragFeature(n,t),r.updateGeometry(),!1}},e.on("mousemove",this.mousemove),this.mouseup=function(t){r.dragObject=null,r.canDragMove=!1,r.dragMoveLocation=null,e.dragPan.enable()},e.on("mouseup",this.mouseup),this.dbclick=function(t){r.end(!0)},e.on("dblclick",this.dbclick)},e.prototype.dragVertex=function(t,e){for(var r=this.pointList,n=t.properties.id,o=0;o<r.length;o++){if(r[o].properties.id===n){r[o].geometry.coordinates=[e.lngLat.lng,e.lngLat.lat];break}}},e.prototype.dragFeature=function(t,e){var r={lng:e.lngLat.lng-this.dragMoveLocation.lng,lat:e.lngLat.lat-this.dragMoveLocation.lat};0==r.lat&&0==r.lng||(l.MoveFeatures.move([t],r),this.dragMoveLocation=e.lngLat,this.pointList=this.getPoints(t.geometry.coordinates))},e.prototype.getPoints=function(t){var e=new i.Point(t);return e.setProperty("meta","vertex"),e.setProperty("active",!1),[e]},e.prototype.updateGeometry=function(){this.source.drawPoint(this.pointList),this.onEditing&&this.onEditing(this.getGeometry())},e.prototype.setPoints=function(t){this.pointList=this.getPoints(t),this.updateGeometry()},e}(s.ModeInterface);e.DrawPoint=c},"A1R+":function(t,e,r){"use strict";t.exports=o,t.exports.default=o;var n=r("YcpW");function o(t,e){if(!(this instanceof o))return new o(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,r,n,o){o||(o=g(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i,a=e;a<r;a++)i=t.children[a],u(o,t.leaf?n(i):i);return o}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function p(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,e,r,o,i){for(var a,s=[e,r];s.length;)(r=s.pop())-(e=s.pop())<=o||(a=e+Math.ceil((r-e)/o/2)*o,n(t,a,e,r,i),s.push(e,a,a,r))}o.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],n=this.toBBox;if(!d(t,e))return r;for(var o,i,a,s,u=[];e;){for(o=0,i=e.children.length;o<i;o++)a=e.children[o],d(t,s=e.leaf?n(a):a)&&(e.leaf?r.push(a):f(t,s)?this._all(a,r):u.push(a));e=u.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!d(t,e))return!1;for(var n,o,i,a,s=[];e;){for(n=0,o=e.children.length;n<o;n++)if(i=e.children[n],d(t,a=e.leaf?r(i):i)){if(e.leaf||f(t,a))return!0;s.push(i)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var o=this.data;this.data=n,n=o}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var r,n,o,a,s=this.data,u=this.toBBox(t),p=[],l=[];s||p.length;){if(s||(s=p.pop(),n=p[p.length-1],r=l.pop(),a=!0),s.leaf&&-1!==(o=i(t,s.children,e)))return s.children.splice(o,1),p.push(s),this._condense(p),this;a||s.leaf||!f(s,u)?n?(r++,s=n.children[r],a=!1):s=null:(p.push(s),l.push(r),r=0,n=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:p,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,n){var o,i=r-e+1,s=this._maxEntries;if(i<=s)return a(o=g(t.slice(e,r+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/Math.pow(s,n-1))),(o=g([])).leaf=!1,o.height=n;var u,p,l,c,h=Math.ceil(i/s),f=h*Math.ceil(Math.sqrt(s));for(y(t,e,r,f,this.compareMinX),u=e;u<=r;u+=f)for(y(t,u,l=Math.min(u+f-1,r),h,this.compareMinY),p=u;p<=l;p+=h)c=Math.min(p+h-1,l),o.children.push(this._build(t,p,c,n-1));return a(o,this.toBBox),o},_chooseSubtree:function(t,e,r,n){for(var o,i,a,s,u,p,l,h,f,d;n.push(e),!e.leaf&&n.length-1!==r;){for(l=h=1/0,o=0,i=e.children.length;o<i;o++)u=c(a=e.children[o]),f=t,d=a,(p=(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-u)<h?(h=p,l=u<l?u:l,s=a):p===h&&u<l&&(l=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,r){var n=this.toBBox,o=r?t:n(t),i=[],a=this._chooseSubtree(o,this.data,e,i);for(a.children.push(t),u(a,o);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(o,i,e)},_split:function(t,e){var r=t[e],n=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,n);var i=this._chooseSplitIndex(r,o,n),s=g(r.children.splice(i,r.children.length-i));s.height=r.height,s.leaf=r.leaf,a(r,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(r,s)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var n,o,i,a,u,p,l,h,f,d,g,y,m,v;for(p=l=1/0,n=e;n<=r-e;n++)o=s(t,0,n,this.toBBox),i=s(t,n,r,this.toBBox),f=o,d=i,g=void 0,y=void 0,m=void 0,v=void 0,g=Math.max(f.minX,d.minX),y=Math.max(f.minY,d.minY),m=Math.min(f.maxX,d.maxX),v=Math.min(f.maxY,d.maxY),a=Math.max(0,m-g)*Math.max(0,v-y),u=c(o)+c(i),a<p?(p=a,h=n,l=u<l?u:l):a===p&&u<l&&(l=u,h=n);return h},_chooseSplitAxis:function(t,e,r){var n=t.leaf?this.compareMinX:p,o=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,o)&&t.children.sort(n)},_allDistMargin:function(t,e,r,n){t.children.sort(n);var o,i,a=this.toBBox,p=s(t,0,e,a),l=s(t,r-e,r,a),c=h(p)+h(l);for(o=e;o<r-e;o++)i=t.children[o],u(p,t.leaf?a(i):i),c+=h(p);for(o=r-e-1;o>=e;o--)i=t.children[o],u(l,t.leaf?a(i):i),c+=h(l);return c},_adjustParentBBoxes:function(t,e,r){for(var n=r;n>=0;n--)u(e[n],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():a(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},AKIq:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("/rf6");e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,o=t.features;n<o.length;n++){var i=o[n];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+i.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},AbFK:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.nomalSourceId="normalF",this.highlightSourceId="highlightF",this.highlightTmsSourceId="",this.Normal_Point="Normal_Point",this.Normal_LineString="Normal_LineString",this.Normal_Polygon="Normal_Polygon",this.Highlight_Point="Highlight_Point",this.Highlight_Line="Highlight_Line",this.Highlight_Polygon="Highlight_Polygon",this.Highlight_Tms="",this.showBeforeId="",this.highlightBeforeId="",this.jsonData={type:"FeatureCollection",features:[]},this.highlightData={type:"FeatureCollection",features:[]},this.inited=!1,this.map=t}return t.prototype.init=function(t){this.inited||(this.inited=!0,this.map.getMap().getSource(this.nomalSourceId)||this.map.getMap().addSource(this.nomalSourceId,{type:"geojson",data:this.jsonData}),this.map.getMap().getSource(this.highlightSourceId)||this.map.getMap().addSource(this.highlightSourceId,{type:"geojson",data:this.highlightData}),t&&(null!=t.showBeforeId&&(this.showBeforeId=t.showBeforeId),null!=t.highlightBeforeId&&(this.highlightBeforeId=t.highlightBeforeId)))},t.prototype.highlight=function(t,e){e&&e.sourceLayer&&e.sourceId?t&&(this.Highlight_Tms=e.sourceId,this.highlightTmsSourceId=e.sourceId,this.addHighlightLayerByType(t.geometry.type,e)):(this.init(e),t&&(this.highlightData.features.push(t),this.map.getMap().getSource(this.highlightSourceId).setData(this.highlightData),this.addHighlightLayerByType(t.geometry.type,e)))},t.prototype.clearHighlight=function(t){this.highlightData&&(this.highlightData.features=[]),this.map.getMap().getSource(this.highlightSourceId)&&this.map.getMap().getSource(this.highlightSourceId).setData({type:"FeatureCollection",features:[]}),this.map.getMap().getLayer(this.Highlight_Point)&&this.map.getMap().removeLayer(this.Highlight_Point),this.map.getMap().getLayer(this.Highlight_Line)&&this.map.getMap().removeLayer(this.Highlight_Line),this.map.getMap().getLayer(this.Highlight_Polygon)&&this.map.getMap().removeLayer(this.Highlight_Polygon),this.map.getMap().getLayer(this.Highlight_Tms)&&this.map.getMap().removeLayer(this.Highlight_Tms)},t.prototype.clear=function(){this.jsonData&&(this.jsonData.features=[]),this.highlightData&&(this.highlightData.features=[]),this.map.getMap().getSource(this.nomalSourceId)&&this.map.getMap().getSource(this.nomalSourceId).setData({type:"FeatureCollection",features:[]}),this.map.getMap().getLayer(this.Normal_Point)&&this.map.getMap().removeLayer(this.Normal_Point),this.map.getMap().getLayer(this.Normal_LineString)&&this.map.getMap().removeLayer(this.Normal_LineString),this.map.getMap().getLayer(this.Normal_Polygon)&&this.map.getMap().removeLayer(this.Normal_Polygon)},t.prototype.addHighlightLayerByType=function(t,e){switch(t){case"Point":case"MultiPoint":this.addHighlightPointLayer(e);break;case"LineString":case"MultiLineString":this.addHighlightLineLayer(e);break;case"Polygon":case"MultiPolygon":this.addHighlightPolygonLayer(e)}},t.prototype.addHighlightPointLayer=function(t){var e=t&&t.layout?t.layout:{"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-anchor":"top"},r=t&&t.paint?t.paint:{},n=t&&t.filter?t.filter:["==","$type","Point"];if(t&&t.sourceLayer&&t.sourceId){var o=t.sourceLayer;this.map.getMap().getLayer(this.Highlight_Tms)||this.addTmsLayer(this.Highlight_Tms,"symbol",this.highlightTmsSourceId,e,r,n,o,this.highlightBeforeId)}else this.map.getMap().getLayer(this.Highlight_Point)||this.addLayer(this.Highlight_Point,"symbol",this.highlightSourceId,e,r,n,this.highlightBeforeId)},t.prototype.addHighlightLineLayer=function(t){var e=t&&t.layout?t.layout:{"line-join":"round","line-cap":"round"},r=t&&t.paint?t.paint:{"line-color":"rgba(200, 0, 0, 0.5)","line-width":8},n=t&&t.filter?t.filter:["==","$type","LineString"];if(t&&t.sourceLayer&&t.sourceId){var o=t.sourceLayer;this.map.getMap().getLayer(this.Highlight_Tms)||this.addTmsLayer(this.Highlight_Tms,"line",this.highlightTmsSourceId,e,r,n,o,this.highlightBeforeId)}else this.map.getMap().getLayer(this.Highlight_Line)||this.addLayer(this.Highlight_Line,"line",this.highlightSourceId,e,r,n,this.highlightBeforeId)},t.prototype.addHighlightPolygonLayer=function(t){var e=t&&t.layout?t.layout:{},r=t&&t.paint?t.paint:{"fill-color":"rgba(200, 0, 0, 0.5)","fill-opacity":.8},n=t&&t.filter?t.filter:["==","$type","Polygon"];if(t&&t.sourceLayer&&t.sourceId){var o=t.sourceLayer;this.map.getMap().getLayer(this.Highlight_Tms)||this.addTmsLayer(this.Highlight_Tms,"fill",this.highlightTmsSourceId,e,r,n,o,this.highlightBeforeId)}else this.map.getMap().getLayer(this.Highlight_Polygon)||this.addLayer(this.Highlight_Polygon,"fill",this.highlightSourceId,e,r,n,this.highlightBeforeId)},t.prototype.addLayer=function(t,e,r,n,o,i,a){null!=a&&""!=a?this.map.getMap().addLayer({id:t,type:e,source:r,layout:n,paint:o,filter:i},a):this.map.getMap().addLayer({id:t,type:e,source:r,layout:n,paint:o,filter:i})},t.prototype.addTmsLayer=function(t,e,r,n,o,i,a,s){null!=s&&""!=s?this.map.getMap().addLayer({id:t,type:e,source:r,layout:n,paint:o,filter:i,"source-layer":a},s):this.map.getMap().addLayer({id:t,type:e,source:r,layout:n,paint:o,filter:i,"source-layer":a})},t}();e.MbRender=n},BK27:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.pmap=t,this.layer=e}return t.prototype.getId=function(){return this.layer.id},t.prototype.getType=function(){return this.layer.type},t.prototype.setPaintProperty=function(t,e){this.pmap.setPaintProperty(this.layer.id,t,e)},t.prototype.setLayoutProperty=function(t,e){this.pmap.setLayoutProperty(this.layer.id,t,e)},t.prototype.setFilter=function(t){this.pmap.setFilter(this.layer,t)},t.prototype.setVisible=function(t){var e=this.layer.id,r=t?"visible":"none";this.pmap.setLayoutProperty(e,"visibility",r)},t.prototype.setGroup=function(t){},t.prototype.getGroup=function(){return""},t.prototype.setIndex=function(t){},t.prototype.getIndex=function(){return 0},t}();e.MbLayer=n},BWdv:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("iHm6"),o=r("vbmK"),i=function(){function t(){}return t.hit=function(t,e){for(var r=e.properties.id,n=0;n<t.length;n++){if(t[n].properties.id===r){t[n].properties.meta="vertex",t[n].properties.active=!0;break}}},t.create=function(e,r){r=this.clear(r);for(var n=[],o=0;o<r.length-1;o++){var i=r[o],a=r[o+1];n.push(i);var s=t.innerCreate(i,a,e);s&&n.push(s),o==r.length-2&&n.push(a)}return n},t.clear=function(t){for(var e=[],r=0;r<t.length;r++)"vertex"===t[r].properties.meta&&e.push(t[r]);return e},t.innerCreate=function(t,e,r){var i=t.geometry.coordinates,a=e.geometry.coordinates;if(i[1]>n.Constants.LAT_RENDERED_MAX||i[1]<n.Constants.LAT_RENDERED_MIN||a[1]>n.Constants.LAT_RENDERED_MAX||a[1]<n.Constants.LAT_RENDERED_MIN)return null;var s=r.project([i[0],i[1]]),u=r.project([a[0],a[1]]),p=r.unproject([(s.x+u.x)/2,(s.y+u.y)/2]),l=new o.Point([p.lng,p.lat]);return l.setProperty("meta",n.Constants.meta.MIDPOINT),l},t}();e.CreateMidpoint=i},ClEM:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.closeButton=!0,this.closeOnClick=!0,this.anchor="bottom",this.offset=[0,0],this.className="",this.maxWidth="240px",this.closeEvent=null,this.openEvent=null,this.popupID=""};e.PopupParas=n},CqeP:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("iHm6"),o=r("5XcQ"),i=function(){function t(){}return t.constrain=function(t,e){var r=n.Constants.LAT_MIN,i=n.Constants.LAT_MAX,a=n.Constants.LAT_MIN,s=n.Constants.LAT_MAX,u=n.Constants.LNG_MAX,p=n.Constants.LNG_MIN;t.forEach(function(t){var e=o.GeojsonUtils.getGeojsonBoundingBox(t),n=e[1],l=e[3],c=e[0],h=e[2];n>r&&(r=n),l<i&&(i=l),l>a&&(a=l),n<s&&(s=n),c<u&&(u=c),h>p&&(p=h)});var l=e;return r+l.lat>n.Constants.LAT_RENDERED_MAX&&(l.lat=n.Constants.LAT_RENDERED_MAX-r),a+l.lat>n.Constants.LAT_MAX&&(l.lat=n.Constants.LAT_MAX-a),i+l.lat<n.Constants.LAT_RENDERED_MIN&&(l.lat=n.Constants.LAT_RENDERED_MIN-i),s+l.lat<n.Constants.LAT_MIN&&(l.lat=n.Constants.LAT_MIN-s),u+l.lng<=n.Constants.LNG_MIN&&(l.lng+=360*Math.ceil(Math.abs(l.lng)/360)),p+l.lng>=n.Constants.LNG_MAX&&(l.lng-=360*Math.ceil(Math.abs(l.lng)/360)),l},t}();e.ConstrainFeatureMovement=i},DdEf:function(t,e,r){"use strict";var n=r("wBzb"),o=r("0b1U");t.exports=function(t,e){var r=t.length;if(1===r){var i=n(t[0],e);return i[0]?i:[i[1]]}var a=new Array(2*r),s=[.1,.1],u=[.1,.1],p=0;n(t[0],e,s),s[0]&&(a[p++]=s[0]);for(var l=1;l<r;++l){n(t[l],e,u);var c=s[1];o(c,u[0],s),s[0]&&(a[p++]=s[0]);var h=u[1],f=s[1],d=h+f,g=d-h,y=f-g;s[1]=d,y&&(a[p++]=y)}s[1]&&(a[p++]=s[1]);0===p&&(a[p++]=0);return a.length=p,a}},EfW4:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("CqeP"),o=r("iHm6"),i=function(){function t(){}return t.move=function(t,e){var r=n.ConstrainFeatureMovement.constrain(t,e);t.forEach(function(t){var e,n=t.geometry.coordinates,i=function(t){var e={lng:t[0]+r.lng,lat:t[1]+r.lat};return[e.lng,e.lat]},a=function(t){return t.map(function(t){return i(t)})};t.geometry.type===o.Constants.geojsonTypes.POINT?e=i(n):t.geometry.type===o.Constants.geojsonTypes.LINE_STRING||t.type===o.Constants.geojsonTypes.MULTI_POINT?e=n.map(i):t.geometry.type===o.Constants.geojsonTypes.POLYGON||t.type===o.Constants.geojsonTypes.MULTI_LINE_STRING?e=n.map(a):t.geometry.type===o.Constants.geojsonTypes.MULTI_POLYGON&&(e=n.map(function(t){return t.map(function(t){return a(t)})})),t.geometry.coordinates=e})},t}();e.MoveFeatures=i},F0BF:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r("KR7H")),r("rI18"),r("1Dt2");var n=r("KR7H"),o=r("AbFK"),i=r("TBUm"),a=r("ugZ8"),s=r("i7HO"),u=r("19Z0"),p=r("mYRg"),l=new n.MapBoxMap;map.Container.set("map",l),map.Container.set("render",new o.MbRender(l)),map.Container.set("popup",new i.MbPopupManage(l)),map.Container.set("marker",new a.MbMarkerManage(l)),map.Container.set("draw",new s.MbDraw(l)),map.Container.set("measure",new u.MbMeasure(l)),map.Container.set("plotting",new p.MbPlotting(l))},"FTm/":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.hat=function(t,e){if(e||(e=16),void 0===t&&(t=128),t<=0)return"0";for(var r=Math.log(Math.pow(2,t))/Math.log(e),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,t/n))/Math.log(e)*n;var o=r-Math.floor(r),i="";for(n=0;n<Math.floor(r);n++){i=Math.floor(Math.random()*e).toString(e)+i}if(o){var a=Math.pow(e,o);i=Math.floor(Math.random()*a).toString(e)+i}var s=parseInt(i,e);return s!==1/0&&s>=Math.pow(2,t)?this.hat(t,e):i},t}();e.Hat=n},HDVh:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("FTm/"),o=function(){function t(t){this.type="Feature",this.geometry={coordinates:[],type:""},this.id=n.Hat.hat(),this.properties={},this.properties.id=this.id}return t.prototype.setCoordinates=function(t){this.geometry.coordinates=t},t.prototype.getCoordinates=function(){return this.geometry.coordinates},t.prototype.setProperty=function(t,e){this.properties[t]=e},t}();e.Feature=o},HUdc:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.element=null,this.anchor="bottom",this.offset=[0,0],this.color="#3FB1CE",this.draggable=!1,this.dragstartEvent=null,this.dragendEvent=null,this.clickEvent=null};e.MarkerParas=n},J8z6:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){var t=this;this.draw.start("polygon",function(e){null!=e&&(""===t.fid?(t.fid=e.id,e.properties.$type="Polygon",t.source.add(e)):(e.id=t.fid,t.source.edit(e),t.draw.clear()))},function(e){null!=e&&(e.id=t.fid,t.source.edit(e))})},e}(r("34Jj").Base);e.Polygon=i},KR7H:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("nC61"),o=r("QaYo"),i=r("eDQc"),a=r("UpkK"),s=r("zMfC"),u=r("BK27"),p=r("O27v"),l=r("itw6"),c=r("Q2Sa"),h=function(){function t(){this.ces={},this._startPitch=0}return t.prototype.init=function(t,e,r){mapboxgl.accessToken=map.Config.MapboxAccessToken,e=e||new n.MapParas;var o={container:t};map.Factory.copy(e,o,!0);var a="";o.style&&(a=o.style,delete o.style);var s=map.Config.OfflineHandler;if(s&&(map.Config.openOffline=o.offline=0!=o.offline),this.pmap=new mapboxgl.Map(o),s&&this.pmap.registerOffline(s),this.setStyle(a),this.mapParam=o,e.controls&&e.controls.length>0)for(var u=0;u<e.controls.length;u++){var p=e.controls[u];p===i.MapConstants.ControlTypes.Scale&&this.addControl(i.MapConstants.ControlTypes.Scale,{maxWidth:80,unit:"metric"}),p===i.MapConstants.ControlTypes.Navigation&&this.addControl(i.MapConstants.ControlTypes.Navigation,{position:"bottom-right"})}var l=this;if(this.pmap.on("load",function(){r&&r(l)}),e.doubleTouch){var c=document.getElementById(t);c.ontouchstart=function(t){l.touchstart(l,t)},c.ontouchmove=function(t){l.touchmove(l,t)}}},t.prototype.touchstart=function(t,e){2===e.touches.length&&(t.ces.start1={x:e.touches[0].pageX,y:e.touches[0].pageY},t.ces.start2={x:e.touches[1].pageX,y:e.touches[1].pageY},t._startPitch=t.pmap.getPitch())},t.prototype.touchmove=function(t,e){if(2===e.touches.length){t.ces.end1={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY},t.ces.end2={x:e.changedTouches[1].pageX,y:e.changedTouches[1].pageY};var r=t.ces.end1.x-t.ces.start1.x,n=t.ces.end2.x-t.ces.start2.x,o=t.ces.end1.y-t.ces.start1.y,i=t.ces.end2.y-t.ces.start2.y;if(o>=0&&i<=0||o<=0&&i>=0)return;if(r>=0&&n<=0||r<=0&&n>=0)return;var a=(o+i)/2*.3;t.pmap.setPitch(t._startPitch+a),e.stopPropagation()}},t.prototype.resize=function(){this.pmap.resize()},t.prototype.remove=function(){this.pmap&&this.pmap.remove(),this.pmap=null},t.prototype.setStyle=function(t,e){null!==t&&""!==t&&("string"==typeof t?t.startsWith("mapbox://")?this.pmap.setStyle(t):t.startsWith("fm://")?this.loadFmStyle(t,e):t.startsWith("minemap://")?this.loadMineStyle(t,e):this.loadStyle(t,e):(e&&e.before&&e.before(t),this.pmap.setStyle(t)))},t.prototype.loadFmStyle=function(t,e){var r=this,n=t.replace("fm://",map.Config.BaseUrl);map.Config.FmTokenSID&&map.Config.FmTokenPWD&&(n+="?sid="+map.Config.FmTokenSID+"&spwd="+map.Config.FmTokenPWD),a.StyleLoadService.loadFMMapStyle(n,function(t){r.beforeStyle(t,e),r.pmap.setStyle(p.MbStyleService.transfer(t))},function(){throw new Error("Failed to load Style")})},t.prototype.loadStyle=function(t,e){var r=this;a.StyleLoadService.loadStyle(t,function(t){r.beforeStyle(t,e),r.pmap.setStyle(t)},function(){throw new Error("Failed to load Style")})},t.prototype.loadMineStyle=function(t,e){var r=this,n=t.replace("minemap://",map.Config.BaseUrl);a.StyleLoadService.loadMineMapStyle(n,function(t){r.beforeStyle(t,e),r.pmap.setStyle(t)},function(){throw new Error("Failed to load Style")})},t.prototype.beforeStyle=function(t,e){e&&e.before&&e.before(t)},t.prototype.fullExtent=function(){var t=this.mapParam.fullExtent;t&&this.flyTo(t)},t.prototype.addControl=function(t,e){if(e=e||new o.MapControlParas,this.pmap)switch(t){case i.MapConstants.ControlTypes.Navigation:if(this.NavigationControl)return;this.NavigationControl=new mapboxgl.NavigationControl(e),this.pmap.addControl(this.NavigationControl,e.position);break;case i.MapConstants.ControlTypes.Geolocate:if(this.GeolocateControl)return;this.GeolocateControl=new mapboxgl.GeolocateControl(e),this.pmap.addControl(this.GeolocateControl,e.position);break;case"AttributionControl":if(this.AttributionControl)return;this.AttributionControl=new mapboxgl.AttributionControl(e),this.pmap.addControl(this.AttributionControl,e.position);break;case i.MapConstants.ControlTypes.Scale:if(this.ScaleControl)return;this.ScaleControl=new mapboxgl.ScaleControl(e),this.pmap.addControl(this.ScaleControl,e.position);break;case"Language":if(this.language)return;if("undefined"!=typeof MapboxLanguage)this.language=new MapboxLanguage(e),this.pmap.addControl(this.language);else{var r=this;map.Factory.loadJS(map.Factory.filePath+"script/mb/v1.8.1/mapbox-gl-language.js",function(){r.language=new MapboxLanguage(e),r.pmap.addControl(r.language)})}break;case i.MapConstants.ControlTypes.FullScreen:if(this.FullscreenControl)return;this.FullscreenControl=new mapboxgl.FullscreenControl(e),this.pmap.addControl(this.FullscreenControl,e.position);break;case i.MapConstants.ControlTypes.MiniMap:var n=this.getZoom()>2?this.getZoom()-2:this.getZoom();if(void 0!==mapboxgl.Minimap)this.addMinMap(n,e,e.position);else{var a=this,s=e;map.Factory.loadJS(map.Factory.filePath+"script/mb/v1.8.1/mapboxgl-control-minimap.js",function(){a.addMinMap(n,s,s.position)})}}},t.prototype.addMinMap=function(t,e,r){if(!this.MinimapControl){var n={center:this.getCenter(),zoom:t,dragPan:!0,scrollZoom:!0};e=e||n,map.Factory.copy(e,n,!0),this.MinimapControl=new mapboxgl.Minimap(n),this.pmap.addControl(this.MinimapControl,r)}},t.prototype.removeControl=function(t){if(this.pmap)switch(t){case"Navigation":this.NavigationControl&&(this.pmap.removeControl(this.NavigationControl),this.NavigationControl=null);break;case"Geolocate":this.GeolocateControl&&(this.pmap.removeControl(this.GeolocateControl),this.GeolocateControl=null);break;case"AttributionControl":this.AttributionControl&&(this.pmap.removeControl(this.AttributionControl),this.AttributionControl=null);break;case"Scale":this.ScaleControl&&(this.pmap.removeControl(this.ScaleControl),this.ScaleControl=null);break;case"Language":this.language&&(this.pmap.removeControl(this.language),this.language=null);break;case i.MapConstants.ControlTypes.FullScreen:this.FullscreenControl&&(this.pmap.removeControl(this.FullscreenControl),this.FullscreenControl=null);break;case i.MapConstants.ControlTypes.MiniMap:this.MinimapControl&&(this.pmap.removeControl(this.MinimapControl),this.MinimapControl=null)}},t.prototype.getZoom=function(){return this.pmap.getZoom()},t.prototype.getCenter=function(){var t=this.pmap.getCenter();return[t.lng,t.lat]},t.prototype.getExtent=function(){var t=this.pmap.getBounds();return{xmin:t._sw.lng,ymin:t._sw.lat,xmax:t._ne.lng,ymax:t._ne.lat}},t.prototype.on=function(t,e,r){switch(t){case l.EvenType.CLICK:c.MbEvent.clickEvent(l.EvenType.CLICK,this.pmap,e);break;case l.EvenType.MOUSE_MOVE:c.MbEvent.mouseMoveEvent(l.EvenType.MOUSE_MOVE,this.pmap,e);break;default:r?this.pmap.on(t,r,e):this.pmap.on(t,e)}},t.prototype.un=function(t,e,r){r?this.pmap.off(t,r,e):this.pmap.off(t,e)},t.prototype.getMap=function(){return this.pmap},t.prototype.exportPng=function(t){if(this.pmap.isStyleLoaded()){var e=this.pmap.getCanvas();navigator.msSaveBlob?navigator.msSaveBlob(e.msToBlob(),t+".png"):e.toBlob(function(e){"undefined"!=typeof saveAs?saveAs(e,t+".png"):map.Factory.loadJS(map.Factory.filePath+"script/utils/FileSaver.min.js",function(){saveAs(e,t+".png")})})}},t.prototype.exportPdf=function(t,e){var r=this;if(this.pmap.isStyleLoaded()){var n=this.pmap.getCanvas(),o=e&&e.width?e.width:n.width,i=e&&e.height?e.height:n.height;"undefined"!=typeof jsPDF?r.savepdf(n,t,o,i):map.Factory.loadJS(map.Factory.filePath+"script/utils/jspdf.min.js",function(){r.savepdf(n,t,o,i)})}},t.prototype.savepdf=function(t,e,r,n){var o=new jsPDF({orientation:r>n?"l":"p",unit:"mm",format:[r,n],compress:!0});o.addImage(t.toDataURL("image/png"),"png",0,0,r,n,null,"FAST"),o.save(e+".pdf")},t.prototype.flyTo=function(t){this.pmap.fitBounds([[t.xmin,t.ymin],[t.xmax,t.ymax]])},t.prototype.fitBounds=function(t,e){this.getMap().fitBounds([[t.xmin,t.ymin],[t.xmax,t.ymax]],e)},t.prototype.easeTo=function(t){this.getMap().easeTo(t)},t.prototype.zoomToPoint=function(t,e,r){r=r||this.getZoom(),this.getMap().setCenter([t,e]).setZoom(r)},t.prototype.zoomToLevel=function(t,e,r){var n=null;n=e&&r?[e,r]:this.getCenter(),this.getMap().setCenter(n).setZoom(t)},t.prototype.zoomToExtent=function(t){this.pmap.fitBounds([[t[0],t[1]],[t[2],t[3]]])},t.prototype.setEdgeAutoExtend=function(t){},t.prototype.addSource=function(t,e){if(this.pmap.getSource(t))throw new Error("souece ID: "+t+"已存在");var r;return r=e.serverType?mapboxGlStyleSpecificationForOl.MbSourceUtil.getSourceByServerType(e):mapboxGlStyleSpecificationForOl.MbSourceUtil.getSourceByType(e),this.pmap.addSource(t,r),new s.MbSource(this.pmap,t,r)},t.prototype.addLayer=function(t,e,r,n){if(""==t||""==e&&"background"!=r.type)return null;if(this.pmap.getLayer(t))throw new Error("Layer ID: "+t+"已存在");var o={id:t,source:e};return map.Factory.copy(r,o,!0),n?this.pmap.addLayer(o,n):this.pmap.addLayer(o),new u.MbLayer(this.pmap,o)},t.prototype.getSource=function(t){var e=null;if(""==t)return null;var r=this.pmap.getSource(t);return r&&(e=new s.MbSource(this.pmap,t,r)),e},t.prototype.getLayer=function(t){var e=null;if(""==t)return null;var r=this.pmap.getLayer(t);return r&&(e=new u.MbLayer(this.pmap,r)),e},t.prototype.getAllLayer=function(){var t=this;if(this.pmap.getStyle()){var e=void 0,r=[];return(e=this.pmap.getStyle().layers).length>0&&e.forEach(function(e){var n=new u.MbLayer(t.pmap,e);r.push(n)}),r}return null},t.prototype.getLayers=function(t){return null},t.prototype.getLayersBySource=function(t){var e=this,r=this.pmap.getStyle().layers.filter(function(e){return e["source-layer"]&&t===e["source-layer"]}),n=[];return r&&r.length>0?(r.forEach(function(t){var r=new u.MbLayer(e.pmap,t);n.push(r)}),n):null},t.prototype.queryRenderedFeaturesByPixel=function(t,e,r){var n,o={layers:[e]};return n=r&&r.tolerance?[[t[0]-r.tolerance,t[1]-r.tolerance],[t[0]+r.tolerance,t[1]+r.tolerance]]:t,this.pmap.queryRenderedFeatures(n,o)},t.prototype.queryRenderedFeaturesByPoint=function(t,e,r){var n=this.pmap.project(t);return this.queryRenderedFeaturesByPixel(n,e,r)},t.prototype.project=function(t){var e=this.pmap.project(t);return[e.x,e.y]},t.prototype.unproject=function(t){var e=this.pmap.unproject(t);return[e.lng,e.lat]},t}();e.MapBoxMap=h},KjEd:function(t,e,r){"use strict";r.r(e);var n=r("ojA+"),o=r.n(n);function i(t,e,r){if(!u(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&p(n),o&&l(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function a(t,e,r){if(!t)throw new Error("coordinates is required");for(var n=0;n<t.length;n++){var o=t[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++){if(0===n&&0===a&&!s(o[0][0])||!s(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}}return i({type:"Polygon",coordinates:t},e,r)}function s(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function u(t){return!!t&&t.constructor===Object}function p(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!s(t))throw new Error("bbox must only contain numbers")})}function l(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function c(t,e,r){if(null!==t)for(var n,o,i,a,s,u,p,l,h=0,f=0,d=t.type,g="FeatureCollection"===d,y="Feature"===d,m=g?t.features.length:1,v=0;v<m;v++){s=(l=!!(p=g?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===p.type)?p.geometries.length:1;for(var M=0;M<s;M++){var b=0,_=0;if(null!==(a=l?p.geometries[M]:p)){u=a.coordinates;var P=a.type;switch(h=!r||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===e(u,f,v,b,_))return!1;f++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],f,v,b,_))return!1;f++,"MultiPoint"===P&&b++}"LineString"===P&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-h;o++){if(!1===e(u[n][o],f,v,b,_))return!1;f++}"MultiLineString"===P&&b++,"Polygon"===P&&_++}"Polygon"===P&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for("MultiPolygon"===P&&(_=0),o=0;o<u[n].length;o++){for(i=0;i<u[n][o].length-h;i++){if(!1===e(u[n][o][i],f,v,b,_))return!1;f++}_++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===c(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}e.default=function(t,e){if(!u(e=e||{}))throw new Error("options is invalid");var r=e.concavity||1/0,n=[];if(c(t,function(t){n.push([t[0],t[1]])}),!n.length)return null;var i=o()(n,r);return i.length>3?a([i]):null}},MDZM:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.ArctoGeojson=function(t,e){return Terraformer.ArcGIS.parse(t,e)},t.GeojsonToArc=function(t,e){return Terraformer.ArcGIS.convert(t,e)},t.GeoGeometryToWkt=function(t){return Terraformer.WKT.convert(t)},t.WktToGeoGeometry=function(t){return Terraformer.WKT.parse(t)},t.ArcToGeoCollection=function(e){if(null==e||e.length<0)return null;var r=[];return e.forEach(function(e){var n={},o=t.ArctoGeojson(e.geometry);n.properties=e.attributes,n.type="Feature",n.geometry=o,r.push(n)}),{type:"FeatureCollection",features:r}},t.ArcToGeoJson=function(t){if(null==t)return null;var e=this.ArctoGeojson(t.geometry);return{properties:t.attributes?t.attributes:{},type:"Feature",geometry:e}},t}();e.TerraformerUtils=n},NC79:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=r("g+WE"),a=r("8SP6"),s=r("BWdv"),u=r("vbmK"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pointListForLine=[],e}return o(e,t),e.prototype.getType=function(){return"draw_line_string"},e.prototype.addPointAndDraw=function(e){t.prototype.addPointAndDraw.call(this,e),this.pointListForLine.push(e),this.source.drawLine(this.pointListForLine)},e.prototype.delPoint=function(){t.prototype.delPoint.call(this),this.drawing&&(this.pointListForLine.length>0&&this.pointListForLine.pop(),this.source.drawLine(this.pointListForLine))},e.prototype.getGeometry=function(){return this.pointListForLine.length<=0?null:new i.LineString(this.pointListForLine)},e.prototype.editStart=function(){t.prototype.editStart.call(this)},e.prototype.updateGeometry=function(){var t=this.pmap.getMap();this.pointList=s.CreateMidpoint.clear(this.pointList),this.pointList=s.CreateMidpoint.create(t,this.pointList),this.source.drawPoint(this.pointList),this.pointListForLine=[];for(var e=0;e<this.pointList.length;e++){var r=this.pointList[e];"vertex"===r.properties.meta&&this.pointListForLine.push(r.geometry.coordinates)}this.source.drawLine(this.pointListForLine),this.onEditing&&this.onEditing(this.getGeometry())},e.prototype.getPoints=function(t){var e=[];return t.forEach(function(t){var r=new u.Point(t);r.setProperty("meta","vertex"),r.setProperty("active",!1),e.push(r)}),e},e}(a.DrawPoint);e.DrawLineString=p},O27v:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("n+k/"),o=function(){function t(){}return t.transfer=function(t){for(var e in t.sources){var r=t.sources[e].serverType,o=void 0;o=mapboxGlStyleSpecificationForOl.CommonUtils.isHandle(r)?mapboxGlStyleSpecificationForOl.MbSourceUtil.getSourceByServerType(t.sources[e]):mapboxGlStyleSpecificationForOl.CommonUtils.copy(t.sources[e],new n.MbSoruceParas),t.sources[e]=o}return t},t}();e.MbStyleService=o},"O3R+":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("cWyK"),o=6378137;function i(t){var e=0;if(t&&t.length>0){e+=Math.abs(a(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(a(t[r]))}return e}function a(t){var e,r,n,i,a,u,p=0,l=t.length;if(l>2){for(u=0;u<l;u++)u===l-2?(n=l-2,i=l-1,a=0):u===l-1?(n=l-1,i=0,a=1):(n=u,i=u+1,a=u+2),e=t[n],r=t[i],p+=(s(t[a][0])-s(e[0]))*Math.sin(s(r[1]));p=p*o*o/2}return p}function s(t){return t*Math.PI/180}e.default=function(t){return n.geomReduce(t,function(t,e){return t+function(t){var e,r=0;switch(t.type){case"Polygon":return i(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)r+=i(t.coordinates[e]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)},0)}},"Ogo/":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("g+WE"),o=r("o0BB"),i=function(){function t(){this.emptyFeatures={type:"FeatureCollection",features:[]}}return t.prototype.init=function(t){this.pmap=t;var e=this.pmap.getMap();e.addSource("DRAW_POINT_LAYER_SOURCE_ID",{data:this.emptyFeatures,type:"geojson"}),e.addSource("DRAW_LINE_LAYER_SOURCE_ID",{data:this.emptyFeatures,type:"geojson"}),e.addSource("DRAW_FILL_LAYER_SOURCE_ID",{data:this.emptyFeatures,type:"geojson"}),this.addPolygonLayer(),this.addLineLayer(),this.addPointLayer()},t.prototype.addPointLayer=function(){var t=this.pmap.getMap();t.addLayer({id:"gl-draw-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","active",!1]],paint:{"circle-radius":5,"circle-color":"#fff"},source:"DRAW_POINT_LAYER_SOURCE_ID"});t.addLayer({id:"gl-draw-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","active",!1]],paint:{"circle-radius":3,"circle-color":"#fbb03b"},source:"DRAW_POINT_LAYER_SOURCE_ID"});t.addLayer({id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"},source:"DRAW_POINT_LAYER_SOURCE_ID"});t.addLayer({id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","meta","vertex"],["==","active",!0]],paint:{"circle-radius":7,"circle-color":"#ffffff"},source:"DRAW_POINT_LAYER_SOURCE_ID"});t.addLayer({id:"gl-draw-point-active",type:"circle",filter:["all",["==","meta","vertex"],["==","active",!0]],paint:{"circle-radius":5,"circle-color":"#fbb03b"},source:"DRAW_POINT_LAYER_SOURCE_ID"})},t.prototype.addLineLayer=function(){this.pmap.getMap().addLayer({id:"gl-draw-line-active",type:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2},source:"DRAW_LINE_LAYER_SOURCE_ID"})},t.prototype.addPolygonLayer=function(){var t=this.pmap.getMap(),e={id:"gl-draw-polygon-fill-active",type:"fill",paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1},source:"DRAW_FILL_LAYER_SOURCE_ID"};t.addLayer(e),e={id:"gl-draw-polygon-stroke-active",type:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2},source:"DRAW_FILL_LAYER_SOURCE_ID"},t.addLayer(e)},t.prototype.drawPoint=function(t){var e={type:"FeatureCollection",features:t};this.pmap.getMap().getSource("DRAW_POINT_LAYER_SOURCE_ID").setData(e)},t.prototype.drawLine=function(t){var e={type:"FeatureCollection",features:[new n.LineString(t)]};this.pmap.getMap().getSource("DRAW_LINE_LAYER_SOURCE_ID").setData(e)},t.prototype.drawPolygon=function(t){var e={type:"FeatureCollection",features:[new o.Polygon([t])]};this.pmap.getMap().getSource("DRAW_FILL_LAYER_SOURCE_ID").setData(e)},t.prototype.clear=function(){this.clearPoint(),this.clearLine(),this.clearPonlygon()},t.prototype.clearPoint=function(){this.pmap.getMap().getSource("DRAW_POINT_LAYER_SOURCE_ID").setData(this.emptyFeatures)},t.prototype.clearLine=function(){this.pmap.getMap().getSource("DRAW_LINE_LAYER_SOURCE_ID").setData(this.emptyFeatures)},t.prototype.clearPonlygon=function(){this.pmap.getMap().getSource("DRAW_FILL_LAYER_SOURCE_ID").setData(this.emptyFeatures)},t.layers=["gl-draw-vertex-stroke-inactive","gl-draw-vertex-inactive","gl-draw-midpoint","gl-draw-point-stroke-active","gl-draw-point-active","gl-draw-line-active","gl-draw-polygon-fill-active","gl-draw-polygon-stroke-active"],t}();e.DarwSource=i},"P+s0":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.getMarker=function(t,e,r){var n=new mapboxgl.Marker(r);n.setLngLat(e).addTo(t);var o=r.dragstartEvent;o&&n.on("dragstart",function(t){var e=t.target.getLngLat(),r=[e.lng,e.lat];o&&o(r)});var i=r.dragendEvent;i&&n.on("dragend",function(t){var e=t.target.getLngLat(),r=[e.lng,e.lat];i&&i(r)});var a=r.clickEvent;return a&&(n._element.onclick=function(t){t.stopPropagation(),a&&a()}),n},t}();e.MbMarkerUtil=n},Q2Sa:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("jYz8"),o=function(){function t(){}return t.clickEvent=function(t,e,r){this.commonEvent(t,"click",e,r)},t.mouseMoveEvent=function(t,e,r){this.commonEvent(t,"mousemove",e,r)},t.commonEvent=function(t,e,r,o){r.on(e,function(e){var r=new n.EventResult;e&&(r.type=t,r.lngLat=e.lngLat,r.point=e.point,r.preventDefault=e.preventDefault),o&&o(r)})},t}();e.MbEvent=o},QaYo:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.position="bottom-right",this.maxWidth=80,this.unit="metric"};e.MapControlParas=n},R3bA:function(t,e,r){"use strict";r.r(e);var n=r("KjEd");function o(t,e,r){if(!s(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&u(n),o&&p(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function i(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!a(t[0])||!a(t[1]))throw new Error("coordinates must contain numbers");return o({type:"Point",coordinates:t},e,r)}function a(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function s(t){return!!t&&t.constructor===Object}function u(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!a(t))throw new Error("bbox must only contain numbers")})}function p(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function l(t,e,r){if(null!==t)for(var n,o,i,a,s,u,p,c,h=0,f=0,d=t.type,g="FeatureCollection"===d,y="Feature"===d,m=g?t.features.length:1,v=0;v<m;v++){s=(c=!!(p=g?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===p.type)?p.geometries.length:1;for(var M=0;M<s;M++){var b=0,_=0;if(null!==(a=c?p.geometries[M]:p)){u=a.coordinates;var P=a.type;switch(h=!r||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===e(u,f,v,b,_))return!1;f++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],f,v,b,_))return!1;f++,"MultiPoint"===P&&b++}"LineString"===P&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-h;o++){if(!1===e(u[n][o],f,v,b,_))return!1;f++}"MultiLineString"===P&&b++,"Polygon"===P&&_++}"Polygon"===P&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for("MultiPolygon"===P&&(_=0),o=0;o<u[n].length;o++){for(i=0;i<u[n][o].length-h;i++){if(!1===e(u[n][o][i],f,v,b,_))return!1;f++}_++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===l(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var c=function(t,e){var r=0,n=0,o=0;return l(t,function(t){r+=t[0],n+=t[1],o++},!0),i([r/o,n/o],e)};function h(t,e,r){if(!g(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&y(n),o&&m(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function f(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return h({type:"Point",coordinates:t},e,r)}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function g(t){return!!t&&t.constructor===Object}function y(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})}function m(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function v(t,e,r){if(null!==t)for(var n,o,i,a,s,u,p,l,c=0,h=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,m=0;m<y;m++){s=(l=!!(p=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===p.type)?p.geometries.length:1;for(var M=0;M<s;M++){var b=0,_=0;if(null!==(a=l?p.geometries[M]:p)){u=a.coordinates;var P=a.type;switch(c=!r||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===e(u,h,m,b,_))return!1;h++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],h,m,b,_))return!1;h++,"MultiPoint"===P&&b++}"LineString"===P&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-c;o++){if(!1===e(u[n][o],h,m,b,_))return!1;h++}"MultiLineString"===P&&b++,"Polygon"===P&&_++}"Polygon"===P&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for("MultiPolygon"===P&&(_=0),o=0;o<u[n].length;o++){for(i=0;i<u[n][o].length-c;i++){if(!1===e(u[n][o][i],h,m,b,_))return!1;h++}_++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===v(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}e.default=function t(e,r){switch(function(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}(e)){case"Point":return e;case"Polygon":var o=[];v(e,function(t){o.push(t)});var i,a,s,u,p,l,h,d,g=c(e,r),y=g.geometry.coordinates,m=0,M=0,b=0,_=o.map(function(t){return[t[0]-y[0],t[1]-y[1]]});for(i=0;i<o.length-1;i++)u=(a=_[i])[0],l=a[1],p=(s=_[i+1])[0],b+=d=u*(h=s[1])-p*l,m+=(u+p)*d,M+=(l+h)*d;if(0===b)return g;var P=1/(.5*b*6);return f([y[0]+P*m,y[1]+P*M],r);default:var L=Object(n.default)(e);return L?t(L,r):c(e,r)}}},TBUm:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("ClEM"),o=r("bF9n"),i=function(){function t(t){this.popups=[],this.map=t}return t.prototype.addTextPopup=function(t,e,r,i){(i=i||new n.PopupParas).id=t;var a=new mapboxgl.Popup(i);a.setLngLat(e).setText(r).addTo(this.map.getMap()),i.closeEvent&&a.on("close",i.closeEvent),i.openEvent&&a.on("open",i.openEvent);var s=new o.MbPopup(this.map,t,a);return this.popups.push(s),s},t.prototype.addHtmlPopup=function(t,e,r,i){(i=i||new n.PopupParas).id=t;var a=new mapboxgl.Popup(i);a.setLngLat(e).setHTML(r).addTo(this.map.getMap()),i.closeEvent&&a.on("close",i.closeEvent),i.openEvent&&a.on("open",i.openEvent);var s=new o.MbPopup(this.map,t,a);return this.popups.push(s),s},t.prototype.addDomPopup=function(t,e,r,i){(i=i||new n.PopupParas).id=t;var a=new mapboxgl.Popup(i);a.setLngLat(e).setDOMContent(r).addTo(this.map.getMap()),i.closeEvent&&a.on("close",i.closeEvent),i.openEvent&&a.on("open",i.openEvent);var s=new o.MbPopup(this.map,t,a);return this.popups.push(s),s},t.prototype.removeAll=function(){for(var t=0;t<this.popups.length;t++){var e=this.popups[t];e&&e.isOpen()&&e.remove()}this.popups=[]},t}();e.MbPopupManage=i},TEvw:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("P+s0"),o=function(){function t(t,e,r,n){this.pmap=t,this.mbMarker=r,this.id=e,this.popup=null,this.options=n,this.mbPopupManage=map.Container.get("popup")}return t.prototype.update=function(t){this.mbMarker.setLngLat(t),this.popup&&this.popup.update(t)},t.prototype.addTextPopup=function(t,e){return null!=this.popup&&this.popup.remove(),this.popup=this.mbPopupManage.addTextPopup(this.id,this.mbMarker.getLngLat(),t,e),this.mbMarker.setPopup(this.popup.getMbPopup()),this.popup},t.prototype.addHtmlPopup=function(t,e){return null!=this.popup&&this.popup.remove(),this.popup=this.mbPopupManage.addHtmlPopup(this.id,this.mbMarker.getLngLat(),t,e),this.mbMarker.setPopup(this.popup.getMbPopup()),this.popup},t.prototype.addDomPopup=function(t,e){return null!=this.popup&&this.popup.remove(),this.popup=this.mbPopupManage.addDomPopup(this.id,this.mbMarker.getLngLat(),t,e),this.mbMarker.setPopup(this.popup.getMbPopup()),this.popup},t.prototype.getLngLat=function(){var t=this.mbMarker.getLngLat();return[t.lng,t.lat]},t.prototype.getPopup=function(){return this.popup},t.prototype.togglePopup=function(){this.mbMarker.togglePopup()},t.prototype.getElement=function(){return this.mbMarker.getElement()},t.prototype.updateElement=function(t){if(this.mbMarker){this.options.element=t;var e=n.MbMarkerUtil.getMarker(this.pmap.getMap(),this.mbMarker.getLngLat(),this.options);this.mbMarker.remove(),this.mbMarker=e,this.popup&&this.mbMarker.setPopup(this.popup.getMbPopup())}},t.prototype.remove=function(){this.mbMarker.remove(),this.removePopup()},t.prototype.removePopup=function(){this.popup&&this.popup.remove()},t}();e.MbMarker=o},UpkK:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.loadStyle=function(t,e,r){map.Http.get(t,function(t){e&&e(t)},function(t){r&&r(t)})},t.loadFMMapStyle=function(t,e,r){var n=this,o=t.split("/");map.Config.solution=o[o.length-1],map.Http.post(t,{browser:"1",terminal:"1",memory:1024,kernel:"mapbox"},function(t){if(t.code)r&&r(t);else try{var o=n.parseFmMapStyle(t);e&&e(o)}catch(t){r&&r(t)}},function(t){r&&r(t)})},t.mergeStyle=function(t,e){if(t){if(!e)return t;for(var r in t.sources||(t.sources={}),e.sources||(e.sources={}),e.sources)t.sources[r]=e.sources[r];return t.layers||(t.layers=[]),e.layers||(e.layers=[]),e.layers.forEach(function(e){t.layers.push(e)}),t}},t.parseFmMapStyle=function(t){var e=this,r=function(r){var o=t.sources[r].tiles;if(null!=o&&o.length>0){var i=[];o.forEach(function(t){if(null!=t){var r=e.makeFmSourceURL(t);i.push(r)}}),t.sources[r].tiles=i}var a=t.sources[r].url;if(null!=a){var s=n.makeFmSourceURL(a);t.sources[r].url=s}var u=t.sources[r].data;if(null!=u){var p=n.makeFmSourceURL(u);t.sources[r].data=p}},n=this;for(var o in t.sources)r(o);var i=this.normalizeFmSpriteURL(t.sprite),a=t.layers.concat([]),s=this.normalizeFmGlyphsURL(t.glyphs,"");return t={version:8,sprite:i,glyphs:s,sources:t.sources,layers:a}},t.makeFmSourceURL=function(t){return t.startsWith("fmdata://")?t.replace("fmdata://",map.Config.dataUrl):t},t.normalizeFmSpriteURL=function(t){if(!this.isFmMapURL(t)||!map.Config.BaseUrl)return t;var e=this.parseUrl(t);return map.Config.BaseUrl+"sprite/"+e.authority+e.path},t.normalizeFmGlyphsURL=function(t,e){if(!this.isFmMapURL(t)||!map.Config.BaseUrl)return t;var r=this.parseUrl(t);return map.Config.BaseUrl+"fonts/{fontstack}"+r.path.substr(r.path.lastIndexOf("/"))+".pbf"},t.isFmMapURL=function(t){return 0===t.indexOf("fmmap://")||0===t.indexOf("fm://")},t.loadMineMapStyle=function(t,e,r){var n=this,o=t.split("/"),i=map.Config.solution=o[o.length-1],a=map.Config.adapterStyleIDS;if(a.length>0&&a.indexOf(i)>-1||map.Config.openAdapter){var s=this.getMapType();""!==s&&(t+="/"+s)}this.loadStyle(t,function(o){if(o.errcode)r&&r(o);else try{var i=n.parseMineMapStyle(o);map.Config.onlineConfig&&map.Config.onlineConfig.dwStyle&&(n.mergeStyle(i,map.Config.onlineConfig.dwStyle),i.sprite=map.Config.onlineConfig.dwStyle.sprite),e&&e(i),n.getIsOffline()&&map.Config.OfflineHandler.onSetStyle(n.getOfflineUrl(t),i)}catch(t){throw r&&r(o),new Error(t)}},function(o){if(n.getIsOffline()){var i=map.Config.OfflineHandler.onGetStyle(n.getOfflineUrl(t));e&&e(i)}else r&&r(o)})},t.getIsOffline=function(){return map.Config.OfflineHandler&&map.Config.openOffline},t.getOfflineUrl=function(t){return-1!=t.indexOf("?")&&(t=t.replace(/(\?|#)[^'"]*/,"")),t},t.getMapType=function(){var t="",e=navigator.userAgent.toLowerCase();if(e.indexOf("msie")>0)return t="l";if(e.indexOf("trident")>0){var r=e.match(/trident\/[\d.]+/gi)[0].split("/");switch(r[0]+" "+r[1]){case"trident 4.0":case"trident 5.0":case"trident 6.0":return t="l"}if(window.ActiveXObject||"ActiveXObject"in window)try{var n=new ActiveXObject("WbemScripting.SWbemLocator").ConnectServer("."),o=this.cpuInfo(n),i=this.raminfo(n);t=o<=4&&i<=4096?"l":o<=4&&i>4096&&i<16384?"m":o>=4&&i>=16384?"h":"m"}catch(t){console.log("未启用ActiveXObject")}return t}var a=window.navigator,s=0,u=0,p=a.userAgent;return a.hardwareConcurrency&&(u=a.hardwareConcurrency),p.indexOf("Chrome")>-1&&void 0===a.deviceMemory&&console.warn("Google browser opens chrome://flags/#unsafely-treat-insecure-origin-as-secure set to enabled, fill in the address of this website and restart the browser"),a.deviceMemory&&(s=a.deviceMemory),t=0==s?u<=4?"l":u<8?"m":u>=8?"h":"l":u<=8&&s<=4?"l":u<=8&&s>4&&s<16?"m":u>=8&&s>=16?"h":"m"},t.cpuInfo=function(t){for(var e=t.ExecQuery("SELECT * FROM Win32_Processor"),r=new Enumerator(e),n=0;!r.atEnd();r.moveNext()){n=r.item().NumberOfCores}return n},t.raminfo=function(t){for(var e=new Enumerator(t.ExecQuery("SELECT * FROM Win32_PhysicalMemory")),r=[],n=0;!e.atEnd();e.moveNext())r[n++]={cap:e.item().Capacity/1024/1024,speed:e.item().Speed};for(var o=0,i=0;i<r.length;i++)o+=r[i].cap;return console.log(o),o},t.parseMineMapStyle=function(t){var e=[];for(var r in t.sources){var n=t.sources[r].tiles[0];if(this.isMinemapURL(n)){var o=this.parseTile(n);if(!o)continue;var i=this.makeMineSourceURL(o,map.Config.MineAccessToken,map.Config.solution);e.push(Object.assign({},t.sources[r],{id:r,tiles:[i]}))}else e.push(Object.assign({},t.sources[r],{id:r}))}for(var a=this.normalizeMineSpriteURL(t.sprite,"","",""),s={},u=0;u<e.length;u++)s[e[u].id]=e[u],delete s[e[u].id].id;var p=t.layers.concat([]);for(u=0;u<p.length;u++){if(p[u].filter)for(var l=p[u].filter,c=0;c<l.length;c++)Array.isArray(l[c])&&("!arrin"===l[c][0]&&(l[c][0]="!in"),"arrin"===l[c][0]&&(l[c][0]="in"));"extrusion"===p[u].type&&(p[u]=JSON.parse(JSON.stringify(p[u]).replace(/extrusion/g,"fill-extrusion"))),"sprite"!==p[u].type&&"histogram"!==p[u].type&&"airline"!==p[u].type||(p.splice(u,1),u--),p[u].paint&&("fill-water"in p[u].paint&&delete p[u].paint["fill-water"],"line-border-color"in p[u].paint&&delete p[u].paint["line-border-color"],"line-border-width"in p[u].paint&&delete p[u].paint["line-border-width"],"line-border-opacity"in p[u].paint&&delete p[u].paint["line-border-opacity"]),p[u].layout&&"border-visibility"in p[u].layout&&delete p[u].layout["border-visibility"]}return t={version:8,sprite:a,glyphs:this.normalizeMineGlyphsURL(t.glyphs,""),sources:s,layers:p}},t.makeMineSourceURL=function(t,e,r,n){switch(t.protocol){case"minemap":var o=this.parseUrl(map.Config.SRC_URL);t.protocol=o.protocol,t.authority=o.authority;break;case"minemapdata":var i=this.parseUrl(map.Config.API_URL);t.path=i.path+t.authority+t.path,t.protocol=i.protocol,t.authority=i.authority;break;case"minemapdatad":var a=this.parseUrl(map.Config.DYN_URL);t.path=a.path+t.authority+t.path,t.protocol=a.protocol,t.authority=a.authority;break;case"minemapdatam":var s=this.parseUrl(map.Config.MERGE_URL);t.path=s.path+t.authority+t.path,t.protocol=s.protocol,t.authority=s.authority;break;case"minemapdatao":var u=this.parseUrl(map.Config.OTHER_URL);t.path=u.path+t.authority+t.path,t.protocol=u.protocol,t.authority=u.authority}if(!map.Config.REQUIRE_ACCESS_TOKEN)return this.formatUrl(t);if(e=e||map.Config.MineAccessToken,r=r||map.Config.solution,n=n||map.Config.DATA_VERSION,!e)throw new Error("需要申请accessToken. ");return t.params.push("token="+e),t.params.push("solu="+r),n&&t.params.push("version="+n),this.formatUrl(t)},t.isMinemapURL=function(t){return 0===t.indexOf("minemap:")||0===t.indexOf("minemapdata:")||0===t.indexOf("minemapdatad:")||0===t.indexOf("minemapdatam:")||0===t.indexOf("minemapdatao:")},t.normalizeMineSpriteURL=function(t,e,r,n){if(!this.isMinemapURL(t)&&!map.Config.spriteUrl)return t+""+e+r;var o=this.parseUrl(t);return o.path=map.Config.SRC_URL+"sprite/sprite"+e+r,map.Config.spriteUrl&&map.Config.spriteUrl+""+e+r||o.path},t.normalizeMineGlyphsURL=function(t,e){if(!this.isMinemapURL(t)&&!map.Config.fontsUrl)return t;var r=this.parseUrl(t);return map.Config.fontsUrl&&map.Config.fontsUrl+"/{fontstack}"+r.path.substr(r.path.lastIndexOf("/"))+".pbf"||map.Config.SRC_URL+"fonts/{fontstack}"+r.path.substr(r.path.lastIndexOf("/"))+".pbf"},t.parseUrl=function(t){var e=t.match(/^(\w+):\/\/([^\/?]+)(\/[^?]+)?\??(.+)?/);if(!e){var r=t.match(/^\/\/([^\/?]+)(\/[^?]+)?\??(.+)?/);if(!r)throw new Error("Unable to parse URL object");return{protocol:"",authority:r[1],path:r[2]||"/",params:r[3]?r[3].split("&"):[]}}return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}},t.formatUrl=function(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol&&t.protocol.length>0?t.protocol+"://"+t.authority+t.path+e:window.document.location.protocol+"//"+t.authority+t.path+e},t.parseTile=function(t){if(!t)return t;if(!this.isMinemapURL(t))return t;var e=t.split(":");if(e.length<2)return t;for(var r=e[1].split("/"),n="",o=2;o<r.length;o++)n+="/"+r[o];return{protocol:e[0],path:n,authority:r[1],params:[]}},t}();e.StyleLoadService=n},Xrjk:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("j3ZU")),i=r("cWyK");e.default=function(t,e){return void 0===e&&(e={}),i.segmentReduce(t,function(t,r){var n=r.geometry.coordinates;return t+o.default(n[0],n[1],e)},0)}},YcpW:function(t,e,r){t.exports=function(){"use strict";function t(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(r,n,o,i,a){!function e(r,n,o,i,a){for(;i>o;){if(i-o>600){var s=i-o+1,u=n-o+1,p=Math.log(s),l=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*l*(s-l)/s)*(u-s/2<0?-1:1),h=Math.max(o,Math.floor(n-u*l/s+c)),f=Math.min(i,Math.floor(n+(s-u)*l/s+c));e(r,n,h,f,a)}var d=r[n],g=o,y=i;for(t(r,o,n),a(r[i],d)>0&&t(r,o,i);g<y;){for(t(r,g,y),g++,y--;a(r[g],d)<0;)g++;for(;a(r[y],d)>0;)y--}0===a(r[o],d)?t(r,o,y):t(r,++y,i),y<=n&&(o=y+1),n<=y&&(i=y-1)}}(r,n,o||0,i||r.length-1,a||e)}}()},bF9n:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r){this.map=t,this.mbPopup=r,this.id=e}return t.prototype.getMbPopup=function(){return this.mbPopup},t.prototype.remove=function(){this.mbPopup.remove()},t.prototype.update=function(t){this.mbPopup.setLngLat(t)},t.prototype.updateContentByText=function(t){this.mbPopup.setText(t)},t.prototype.updateContentByHtml=function(t){this.mbPopup.setHTML(t)},t.prototype.updateContentByDom=function(t){this.mbPopup.setDOMContent(t)},t.prototype.isOpen=function(){return this.mbPopup.isOpen()},t}();e.MbPopup=n},cQc6:function(t,e){t.exports=function(t,e){for(var r=t[0],n=t[1],o=!1,i=0,a=e.length-1;i<e.length;a=i++){var s=e[i][0],u=e[i][1],p=e[a][0],l=e[a][1];u>n!=l>n&&r<(p-s)*(n-u)/(l-u)+s&&(o=!o)}return o}},cWyK:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("/rf6");function o(t,e,r){if(null!==t)for(var n,i,a,s,u,p,l,c,h=0,f=0,d=t.type,g="FeatureCollection"===d,y="Feature"===d,m=g?t.features.length:1,v=0;v<m;v++){u=(c=!!(l=g?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var M=0;M<u;M++){var b=0,_=0;if(null!==(s=c?l.geometries[M]:l)){p=s.coordinates;var P=s.type;switch(h=!r||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===e(p,f,v,b,_))return!1;f++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<p.length;n++){if(!1===e(p[n],f,v,b,_))return!1;f++,"MultiPoint"===P&&b++}"LineString"===P&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<p.length;n++){for(i=0;i<p[n].length-h;i++){if(!1===e(p[n][i],f,v,b,_))return!1;f++}"MultiLineString"===P&&b++,"Polygon"===P&&_++}"Polygon"===P&&b++;break;case"MultiPolygon":for(n=0;n<p.length;n++){for(_=0,i=0;i<p[n].length;i++){for(a=0;a<p[n][i].length-h;a++){if(!1===e(p[n][i][a],f,v,b,_))return!1;f++}_++}b++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===o(s.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&!1!==e(t.features[r].properties,r);r++);break;case"Feature":e(t.properties,0)}}function a(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function s(t,e){var r,n,o,i,a,s,u,p,l,c,h=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(r=0;r<g;r++){for(s=f?t.features[r].geometry:d?t.geometry:t,p=f?t.features[r].properties:d?t.properties:{},l=f?t.features[r].bbox:d?t.bbox:void 0,c=f?t.features[r].id:d?t.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=u?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,p,l,c))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],h,p,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,p,l,c))return!1;h++}}function u(t,e){s(t,function(t,r,o,i,a){var s,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,o,{bbox:i,id:a}),r,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var p=0;p<t.coordinates.length;p++){var l={type:s,coordinates:t.coordinates[p]};if(!1===e(n.feature(l,o),r,p))return!1}})}function p(t,e){u(t,function(t,r,i){var a=0;if(t.geometry){var s=t.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var u,p=0,l=0,c=0;return!1!==o(t,function(o,s,h,f,d){if(void 0===u||r>p||f>l||d>c)return u=o,p=r,l=f,c=d,void(a=0);var g=n.lineString([u,o],t.properties);if(!1===e(g,r,i,d,a))return!1;a++,u=o})&&void 0}}})}function l(t,e){if(!t)throw new Error("geojson is required");u(t,function(t,r,o){if(null!==t.geometry){var i=t.geometry.type,a=t.geometry.coordinates;switch(i){case"LineString":if(!1===e(t,r,o,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===e(n.lineString(a[s],t.properties),r,o,s))return!1}}})}e.coordEach=o,e.coordReduce=function(t,e,r,n){var i=r;return o(t,function(t,n,o,a,s){i=0===n&&void 0===r?t:e(i,t,n,o,a,s)},n),i},e.propEach=i,e.propReduce=function(t,e,r){var n=r;return i(t,function(t,o){n=0===o&&void 0===r?t:e(n,t,o)}),n},e.featureEach=a,e.featureReduce=function(t,e,r){var n=r;return a(t,function(t,o){n=0===o&&void 0===r?t:e(n,t,o)}),n},e.coordAll=function(t){var e=[];return o(t,function(t){e.push(t)}),e},e.geomEach=s,e.geomReduce=function(t,e,r){var n=r;return s(t,function(t,o,i,a,s){n=0===o&&void 0===r?t:e(n,t,o,i,a,s)}),n},e.flattenEach=u,e.flattenReduce=function(t,e,r){var n=r;return u(t,function(t,o,i){n=0===o&&0===i&&void 0===r?t:e(n,t,o,i)}),n},e.segmentEach=p,e.segmentReduce=function(t,e,r){var n=r,o=!1;return p(t,function(t,i,a,s,u){n=!1===o&&void 0===r?t:e(n,t,i,a,s,u),o=!0}),n},e.lineEach=l,e.lineReduce=function(t,e,r){var n=r;return l(t,function(t,o,i,a){n=0===o&&void 0===r?t:e(n,t,o,i,a)}),n},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,o=e.featureIndex||0,i=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.segmentIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),u=u||t.features[o].properties,r=t.features[o].geometry;break;case"Feature":u=u||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var p=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=p.length+s-1),n.lineString([p[s],p[s+1]],u,e);case"Polygon":return a<0&&(a=p.length+a),s<0&&(s=p[a].length+s-1),n.lineString([p[a][s],p[a][s+1]],u,e);case"MultiLineString":return i<0&&(i=p.length+i),s<0&&(s=p[i].length+s-1),n.lineString([p[i][s],p[i][s+1]],u,e);case"MultiPolygon":return i<0&&(i=p.length+i),a<0&&(a=p[i].length+a),s<0&&(s=p[i][a].length-s-1),n.lineString([p[i][a][s],p[i][a][s+1]],u,e)}throw new Error("geojson is invalid")},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,o=e.featureIndex||0,i=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.coordIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),u=u||t.features[o].properties,r=t.features[o].geometry;break;case"Feature":u=u||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var p=r.coordinates;switch(r.type){case"Point":return n.point(p,u,e);case"MultiPoint":return i<0&&(i=p.length+i),n.point(p[i],u,e);case"LineString":return s<0&&(s=p.length+s),n.point(p[s],u,e);case"Polygon":return a<0&&(a=p.length+a),s<0&&(s=p[a].length+s),n.point(p[a][s],u,e);case"MultiLineString":return i<0&&(i=p.length+i),s<0&&(s=p[i].length+s),n.point(p[i][s],u,e);case"MultiPolygon":return i<0&&(i=p.length+i),a<0&&(a=p[i].length+a),s<0&&(s=p[i][a].length-s),n.point(p[i][a][s],u,e)}throw new Error("geojson is invalid")}},"e+jV":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.clearHit=function(t){for(var e=0;e<t.length;e++)t[e].properties.active=!1},t.hit=function(t,e){if("vertex"===e.properties.meta)for(var r=e.properties.id,n=0;n<t.length;n++){t[n].properties.id===r&&(t[n].properties.active=!0)}},t}();e.CreateVertex=n},eDQc:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.ControlTypes={Navigation:"Navigation",Scale:"Scale",Geolocate:"Geolocate",FullScreen:"FullScreen",MiniMap:"MiniMap"},t.EventTypes={click:"click",dblclick:"dblclick",movestart:"movestart",moveend:"moveend",zoomstart:"zoomstart",zoomend:"zoomend"},t}();e.MapConstants=n},ffcd:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.BD09ToGCJ2=function(t,e){var r=t-.0065,n=e-.006,o=Math.sqrt(r*r+n*n)-2e-5*Math.sin(n*this.x_PI),i=Math.atan2(n,r)-3e-6*Math.cos(r*this.x_PI);return[o*Math.cos(i),o*Math.sin(i)]},t.GCJ2ToBD09=function(t,e){var r=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*this.x_PI),n=Math.atan2(e,t)+3e-6*Math.cos(t*this.x_PI);return[r*Math.cos(n)+.0065,r*Math.sin(n)+.006]},t.WGSToGCJ2=function(t,e){if(this.out_of_china(t,e))return[t,e];var r=this.transformLat(t-105,e-35),n=this.transformLon(t-105,e-35),o=e/180*this.PI,i=Math.sin(o);i=1-this.ee*i*i;var a=Math.sqrt(i);return r=180*r/(this.a*(1-this.ee)/(i*a)*this.PI),[t+(n=180*n/(this.a/a*Math.cos(o)*this.PI)),e+r]},t.GCJ2ToWGS=function(t,e){if(this.out_of_china(t,e))return[t,e];var r=this.transformLat(t-105,e-35),n=this.transformLon(t-105,e-35),o=e/180*this.PI,i=Math.sin(o);i=1-this.ee*i*i;var a=Math.sqrt(i);return r=180*r/(this.a*(1-this.ee)/(i*a)*this.PI),[2*t-(t+(n=180*n/(this.a/a*Math.cos(o)*this.PI))),2*e-(e+r)]},t.transformLat=function(t,e){var r=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return r+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,r+=2*(20*Math.sin(e*this.PI)+40*Math.sin(e/3*this.PI))/3,r+=2*(160*Math.sin(e/12*this.PI)+320*Math.sin(e*this.PI/30))/3},t.transformLon=function(t,e){var r=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return r+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,r+=2*(20*Math.sin(t*this.PI)+40*Math.sin(t/3*this.PI))/3,r+=2*(150*Math.sin(t/12*this.PI)+300*Math.sin(t/30*this.PI))/3},t.out_of_china=function(t,e){return t<72.004||t>137.8347||e<.8293||e>55.8271||!1},t.BD09ToWGS=function(t,e){var r=this.BD09ToGCJ2(t,e);return this.GCJ2ToWGS(r[0],r[1])},t.WGSToBD09=function(t,e){var r=this.WGSToGCJ2(t,e);return this.GCJ2ToBD09(r[0],r[1])},t.lonLat2Mercator=function(t,e){var r=20037508.34*t/180,n=Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180);return[r,n=20037508.34*n/180]},t.Mercator2lonLat=function(t,e){var r=e/20037508.34*180;return[t/20037508.34*180,r=180/Math.PI*(2*Math.atan(Math.exp(r*Math.PI/180))-Math.PI/2)]},t.x_PI=52.35987755982988,t.PI=3.141592653589793,t.a=6378245,t.ee=.006693421622965943,t}();e.TransformUtils=n},"g+WE":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=r("HDVh"),a=r("iHm6"),s=function(t){function e(e){var r=t.call(this,e)||this;return r.geometry.type=a.Constants.geojsonTypes.LINE_STRING,r.geometry.coordinates=e,r}return o(e,t),e.prototype.isValid=function(){return this.geometry.coordinates.length>1},e.prototype.addCoordinate=function(t,e,r){var n=parseInt(t,10);this.geometry.coordinates.splice(n,0,[e,r])},e.prototype.getCoordinate=function(t){var e=parseInt(t,10);return this.geometry.coordinates[e]},e.prototype.removeCoordinate=function(t){this.geometry.coordinates.splice(parseInt(t,10),1)},e.prototype.updateCoordinate=function(t,e,r){var n=parseInt(t,10);this.geometry.coordinates[n]=[e,r]},e}(i.Feature);e.LineString=s},gkPQ:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.mapEventToBoundingBox=function(t,e){return void 0===e&&(e=0),t&&t.point?[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]:null},t}();e.MapEventToBoundingBox=n},i7HO:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("iHm6"),o=r("Ogo/"),i=r("8SP6"),a=r("NC79"),s=r("58cj"),u=function(){function t(t){this.source=null,this.inited=!1,this.curMode=null,this.pmap=t}return t.prototype.init=function(){this.inited||(this.inited=!0,this.source=new o.DarwSource,this.source.init(this.pmap))},t.prototype.start=function(t,e,r){this.init(),null!=this.curMode&&(this.curMode.clear(),this.curMode.end()),"point"===t?this.curMode=new i.DrawPoint:"line"===t?this.curMode=new a.DrawLineString:"polygon"===t&&(this.curMode=new s.DrawPolygon),this.curMode&&(this.curMode.init(this.pmap,this.source),this.curMode.start(e,r))},t.prototype.edit=function(t,e,r){if(t){if(t.geometry.type===n.Constants.geojsonTypes.POINT)this.start("point",e,r);else if(t.geometry.type===n.Constants.geojsonTypes.LINE_STRING)this.start("line",e,r);else{if(t.geometry.type!==n.Constants.geojsonTypes.POLYGON)throw new Error("不支持MULTI_空间类型！");this.start("polygon",e,r)}if(this.curMode){var o=t.geometry.coordinates;this.curMode.setPoints(o),this.curMode.end(),this.curMode.editStart()}}},t.prototype.addPoint=function(t){this.curMode&&this.curMode.addPoint(t)},t.prototype.delPoint=function(){this.curMode&&this.curMode.delPoint()},t.prototype.end=function(t){this.curMode&&this.curMode.end(t)},t.prototype.clear=function(){this.curMode&&this.curMode.clear()},t.prototype.hasGeometry=function(){return!!this.curMode&&this.curMode.hasGeometry()},t.prototype.getDarwing=function(){return!!this.curMode&&this.curMode.getDarwing()},t.prototype.getGeometry=function(){return!!this.curMode&&this.curMode.getGeometry()},t}();e.MbDraw=u},iHm6:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.geojsonTypes={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},t.meta={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},t.LAT_MIN=-90,t.LAT_RENDERED_MIN=-85,t.LAT_MAX=90,t.LAT_RENDERED_MAX=85,t.LNG_MIN=-270,t.LNG_MAX=270,t}();e.Constants=n},itw6:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.CLICK="click",t.MOUSE_MOVE="mousemove"}(e.EvenType||(e.EvenType={}))},j3ZU:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("AKIq"),o=r("/rf6");e.default=function(t,e,r){void 0===r&&(r={});var i=n.getCoord(t),a=n.getCoord(e),s=o.degreesToRadians(a[1]-i[1]),u=o.degreesToRadians(a[0]-i[0]),p=o.degreesToRadians(i[1]),l=o.degreesToRadians(a[1]),c=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(p)*Math.cos(l);return o.radiansToLength(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r.units)}},jYz8:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.lngLat={lng:null,lat:null},this.point={x:null,y:null},this.type="",this.preventDefault=null};e.EventResult=n},krrK:function(t,e,r){"use strict";var n=r("wBzb"),o=r("oCaR"),i=r("DdEf"),a=r("4QC1"),s=5;function u(t,e){for(var r=new Array(t.length-1),n=1;n<t.length;++n)for(var o=r[n-1]=new Array(t.length-1),i=0,a=0;i<t.length;++i)i!==e&&(o[a++]=t[n][i]);return r}function p(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",p(t.slice(0,e)),",",p(t.slice(e)),")"].join("")}function l(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],r=0;r<t.length;++r)e.push(["scale(",p(l(u(t,r))),",",(n=r,1&n?"-":""),t[0][r],")"].join(""));return e;var n}function c(t){for(var e=[],r=[],s=function(t){for(var e=new Array(t),r=0;r<t;++r){e[r]=new Array(t);for(var n=0;n<t;++n)e[r][n]=["m",n,"[",t-r-1,"]"].join("")}return e}(t),c=[],h=0;h<t;++h)0==(1&h)?e.push.apply(e,l(u(s,h))):r.push.apply(r,l(u(s,h))),c.push("m"+h);var f=p(e),d=p(r),g="orientation"+t+"Exact",y=["function ",g,"(",c.join(),"){var p=",f,",n=",d,",d=sub(p,n);return d[d.length-1];};return ",g].join("");return new Function("sum","prod","scale","sub",y)(o,n,i,a)}var h=c(3),f=c(4),d=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,r){var n,o=(t[1]-r[1])*(e[0]-r[0]),i=(t[0]-r[0])*(e[1]-r[1]),a=o-i;if(o>0){if(i<=0)return a;n=o+i}else{if(!(o<0))return a;if(i>=0)return a;n=-(o+i)}var s=33306690738754716e-32*n;return a>=s||a<=-s?a:h(t,e,r)},function(t,e,r,n){var o=t[0]-n[0],i=e[0]-n[0],a=r[0]-n[0],s=t[1]-n[1],u=e[1]-n[1],p=r[1]-n[1],l=t[2]-n[2],c=e[2]-n[2],h=r[2]-n[2],d=i*p,g=a*u,y=a*s,m=o*p,v=o*u,M=i*s,b=l*(d-g)+c*(y-m)+h*(v-M),_=7771561172376103e-31*((Math.abs(d)+Math.abs(g))*Math.abs(l)+(Math.abs(y)+Math.abs(m))*Math.abs(c)+(Math.abs(v)+Math.abs(M))*Math.abs(h));return b>_||-b>_?b:f(t,e,r,n)}];function g(t){var e=d[t.length];return e||(e=d[t.length]=c(t.length)),e.apply(void 0,t)}!function(){for(;d.length<=s;)d.push(c(d.length));for(var e=[],r=["slow"],n=0;n<=s;++n)e.push("a"+n),r.push("o"+n);var o=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(n=2;n<=s;++n)o.push("case ",n,":return o",n,"(",e.slice(0,n).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),r.push(o.join(""));var i=Function.apply(void 0,r);for(t.exports=i.apply(void 0,[g].concat(d)),n=0;n<=s;++n)t.exports[n]=d[n]}()},mYRg:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("2b6V"),o=r("0+U7"),i=r("J8z6"),a=r("1Ccr"),s=function(){function t(t){this.source=null,this.inited=!1,this.modes={plot_point:n.Point,plot_line:o.LineString,plot_polygon:i.Polygon},this.pmap=t,this.curModel=new n.Point(this.source,"")}return t.prototype.init=function(){this.inited||(this.inited=!0,this.source=new a.PlottingSource,this.source.init(this.pmap))},t.prototype.start=function(t){this.init(),this.curModel&&this.curModel.complete(),this.curModel=new this.modes[t](this.source,""),this.curModel.start()},t.prototype.complete=function(){this.curModel&&this.curModel.complete()},t.prototype.cancel=function(){this.curModel&&this.curModel.cancel()},t}();e.MbPlotting=s},"n+k/":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.type=void 0,this.tiles=void 0,this.url=void 0,this.attribution=void 0,this.data=void 0,this.bounds=void 0,this.scheme=void 0,this.tileSize=void 0,this.maxzoom=void 0,this.minzoom=void 0,this.coordinates=void 0,this.urls=void 0};e.MbSoruceParas=n},nC61:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.projection="EPSG:4326",this.zoom=10,this.maxZoom=24,this.minZoom=1,this.center=[113.26388,23.12946],this.style="mapbox://styles/mapbox/outdoors-v10",this.fullExtent=null,this.preserveDrawingBuffer=!0,this.strategy=["mapboxgl","openlayers","leaflet","cesium"],this.controls=["Scale","Navigation"],this.zoomControl=!1,this.doubleTouch=!1,this.offline=!1};e.MapParas=n},nZZu:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("gkPQ"),o=r("Ogo/"),i=r("1xm4"),a=function(){function t(){}return t.at=function(t,e,r,a){if(null===t)return[];var s=e?n.MapEventToBoundingBox.mapEventToBoundingBox(e,r):a,u={};u.layers=o.DarwSource.layers;var p=t.queryRenderedFeatures(s,u),l=new i.StringSet,c=[];return p.forEach(function(t){var e=t.properties.id;l.has(e)||(l.add(e),c.push(t))}),c},t}();e.FeaturesAt=a},o0BB:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=r("HDVh"),a=r("iHm6"),s=function(t){function e(e){var r=t.call(this,e)||this;return r.geometry.type=a.Constants.geojsonTypes.POLYGON,r.geometry.coordinates=e,r}return o(e,t),e.prototype.isValid=function(){return 0!==this.geometry.coordinates.length&&this.geometry.coordinates.every(function(t){return t.length>2})},e.prototype.incomingCoords=function(t){this.geometry.coordinates=t.map(function(t){return t.slice(0,-1)})},e.prototype.setCoordinates=function(t){this.geometry.coordinates=t},e.prototype.addCoordinate=function(t,e,r){var n=t.split(".").map(function(t){return parseInt(t,10)});this.geometry.coordinates[n[0]].splice(n[1],0,[e,r])},e.prototype.removeCoordinate=function(t){var e=t.split(".").map(function(t){return parseInt(t,10)}),r=this.geometry.coordinates[e[0]];r&&(r.splice(e[1],1),r.length<3&&this.geometry.coordinates.splice(e[0],1))},e.prototype.getCoordinate=function(t){var e=t.split(".").map(function(t){return parseInt(t,10)});return this.geometry.coordinates[e[0]][e[1]]},e.prototype.getCoordinates=function(){return this.geometry.coordinates.map(function(t){return t.concat([t[0]])})},e.prototype.updateCoordinate=function(t,e,r){var n=t.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10);void 0===this.geometry.coordinates[o]&&(this.geometry.coordinates[o]=[]),this.geometry.coordinates[o][i]=[e,r]},e}(i.Feature);e.Polygon=s},oCaR:function(t,e,r){"use strict";t.exports=function(t,e){var r=0|t.length,n=0|e.length;if(1===r&&1===n)return function(t,e){var r=t+e,n=r-t,o=t-(r-n)+(e-n);if(o)return[o,r];return[r]}(t[0],e[0]);var o,i,a=new Array(r+n),s=0,u=0,p=0,l=Math.abs,c=t[u],h=l(c),f=e[p],d=l(f);h<d?(i=c,(u+=1)<r&&(c=t[u],h=l(c))):(i=f,(p+=1)<n&&(f=e[p],d=l(f)));u<r&&h<d||p>=n?(o=c,(u+=1)<r&&(c=t[u],h=l(c))):(o=f,(p+=1)<n&&(f=e[p],d=l(f)));var g,y,m=o+i,v=m-o,M=i-v,b=M,_=m;for(;u<r&&p<n;)h<d?(o=c,(u+=1)<r&&(c=t[u],h=l(c))):(o=f,(p+=1)<n&&(f=e[p],d=l(f))),(M=(i=b)-(v=(m=o+i)-o))&&(a[s++]=M),b=_-((g=_+m)-(y=g-_))+(m-y),_=g;for(;u<r;)(M=(i=b)-(v=(m=(o=c)+i)-o))&&(a[s++]=M),b=_-((g=_+m)-(y=g-_))+(m-y),_=g,(u+=1)<r&&(c=t[u]);for(;p<n;)(M=(i=b)-(v=(m=(o=f)+i)-o))&&(a[s++]=M),b=_-((g=_+m)-(y=g-_))+(m-y),_=g,(p+=1)<n&&(f=e[p]);b&&(a[s++]=b);_&&(a[s++]=_);s||(a[s++]=0);return a.length=s,a}},"ojA+":function(t,e,r){"use strict";var n=r("A1R+"),o=r("yiNX"),i=r("+jW5"),a=r("cQc6"),s=r("krrK")[3];function u(t,e,r){e=Math.max(0,void 0===e?2:e),r=r||0;for(var i,s=function(t){for(var e=t[0],r=t[0],n=t[0],i=t[0],s=0;s<t.length;s++){var u=t[s];u[0]<e[0]&&(e=u),u[0]>n[0]&&(n=u),u[1]<r[1]&&(r=u),u[1]>i[1]&&(i=u)}var p=[e,r,n,i],l=p.slice();for(s=0;s<t.length;s++)a(t[s],p)||l.push(t[s]);var c=o(l),h=[];for(s=0;s<c.length;s++)h.push(l[c[s]]);return h}(t),u=n(16,["[0]","[1]","[0]","[1]"]).load(t),l=[],c=0;c<s.length;c++){var h=s[c];u.remove(h),i=g(h,i),l.push(i)}var f=n(16);for(c=0;c<l.length;c++)f.insert(d(l[c]));for(var m=e*e,v=r*r;l.length;){var M=l.shift(),b=M.p,_=M.next.p,P=y(b,_);if(!(P<v)){var L=P/m;(h=p(u,M.prev.p,b,_,M.next.next.p,L,f))&&Math.min(y(h,b),y(h,_))<=L&&(l.push(M),l.push(g(h,M)),u.remove(h),f.remove(M),f.insert(d(M)),f.insert(d(M.next)))}}M=i;var w=[];do{w.push(M.p),M=M.next}while(M!==i);return w.push(M.p),w}function p(t,e,r,n,o,a,s){for(var u=new i(null,l),p=t.data;p;){for(var h=0;h<p.children.length;h++){var d=p.children[h],g=p.leaf?m(d,r,n):c(r,n,d);g>a||u.push({node:d,dist:g})}for(;u.length&&!u.peek().node.children;){var y=u.pop(),v=y.node,M=m(v,e,r),b=m(v,n,o);if(y.dist<M&&y.dist<b&&f(r,v,s)&&f(n,v,s))return v}(p=u.pop())&&(p=p.node)}return null}function l(t,e){return t.dist-e.dist}function c(t,e,r){if(h(t,r)||h(e,r))return 0;var n=v(t[0],t[1],e[0],e[1],r.minX,r.minY,r.maxX,r.minY);if(0===n)return 0;var o=v(t[0],t[1],e[0],e[1],r.minX,r.minY,r.minX,r.maxY);if(0===o)return 0;var i=v(t[0],t[1],e[0],e[1],r.maxX,r.minY,r.maxX,r.maxY);if(0===i)return 0;var a=v(t[0],t[1],e[0],e[1],r.minX,r.maxY,r.maxX,r.maxY);return 0===a?0:Math.min(n,o,i,a)}function h(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function f(t,e,r){for(var n,o,i,a,u=Math.min(t[0],e[0]),p=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),c=Math.max(t[1],e[1]),h=r.search({minX:u,minY:p,maxX:l,maxY:c}),f=0;f<h.length;f++)if(n=h[f].p,o=h[f].next.p,i=t,n!==(a=e)&&o!==i&&s(n,o,i)>0!=s(n,o,a)>0&&s(i,a,n)>0!=s(i,a,o)>0)return!1;return!0}function d(t){var e=t.p,r=t.next.p;return t.minX=Math.min(e[0],r[0]),t.minY=Math.min(e[1],r[1]),t.maxX=Math.max(e[0],r[0]),t.maxY=Math.max(e[1],r[1]),t}function g(t,e){var r={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(r.next=e.next,r.prev=e,e.next.prev=r,e.next=r):(r.prev=r,r.next=r),r}function y(t,e){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function m(t,e,r){var n=e[0],o=e[1],i=r[0]-n,a=r[1]-o;if(0!==i||0!==a){var s=((t[0]-n)*i+(t[1]-o)*a)/(i*i+a*a);s>1?(n=r[0],o=r[1]):s>0&&(n+=i*s,o+=a*s)}return(i=t[0]-n)*i+(a=t[1]-o)*a}function v(t,e,r,n,o,i,a,s){var u,p,l,c,h=r-t,f=n-e,d=a-o,g=s-i,y=t-o,m=e-i,v=h*h+f*f,M=h*d+f*g,b=d*d+g*g,_=h*y+f*m,P=d*y+g*m,L=v*b-M*M,w=L,C=L;0===L?(p=0,w=1,c=P,C=b):(c=v*P-M*_,(p=M*P-b*_)<0?(p=0,c=P,C=b):p>w&&(p=w,c=P+M,C=b)),c<0?(c=0,-_<0?p=0:-_>v?p=w:(p=-_,w=v)):c>C&&(c=C,-_+M<0?p=0:-_+M>v?p=w:(p=-_+M,w=v));var S=(1-(l=0===c?0:c/C))*o+l*a-((1-(u=0===p?0:p/w))*t+u*r),x=(1-l)*i+l*s-((1-u)*e+u*n);return S*S+x*x}t.exports=u,t.exports.default=u},rI18:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("34V/"),o=r("5XcQ"),i=r("MDZM"),a=r("ffcd"),s=r("tN60");map.Container.set("DataUtils",n.DataUtils),map.Container.set("GeojsonUtils",o.GeojsonUtils),map.Container.set("TerraformerUtils",i.TerraformerUtils),map.Container.set("TransformUtils",a.TransformUtils),map.Container.set("TurfUtils",s.TurfUtils)},tN60:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("O3R+")),i=n(r("Xrjk")),a=n(r("R3bA")),s=function(){function t(){}return t.turfArea=function(t){return o.default(t)},t.turfLength=function(t,e){return i.default(t,e)},t.turfCenterOfMass=function(t,e){return a.default(t,e)},t}();e.TurfUtils=s},ugZ8:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("HUdc"),o=r("TEvw"),i=r("P+s0"),a=function(){function t(t){this.markers=[],this.pmap=t}return t.prototype.add=function(t,e,r){if(!(r=r||new n.MarkerParas).element){var a=window.document.createElement("div");a.id="mb_marker",a.className="mb-marker",r.element=a}var s=i.MbMarkerUtil.getMarker(this.pmap.getMap(),e,r),u=new o.MbMarker(this.pmap,t,s,r);return this.markers.push(u),u},t.prototype.removeAll=function(){for(var t=0;t<this.markers.length;t++){var e=this.markers[t];e&&e.remove()}this.markers=[]},t}();e.MbMarkerManage=a},vbmK:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=r("HDVh"),a=r("iHm6"),s=function(t){function e(e){var r=t.call(this,e)||this;return r.geometry.type=a.Constants.geojsonTypes.POINT,r.geometry.coordinates=e,r}return o(e,t),e.prototype.isValid=function(){return"number"==typeof this.geometry.coordinates[0]&&"number"==typeof this.geometry.coordinates[1]},e.prototype.updateCoordinate=function(t,e,r){3===arguments.length?this.geometry.coordinates=[e,r]:this.geometry.coordinates=[t,e]},e.prototype.getCoordinate=function(){return this.getCoordinates()},e}(i.Feature);e.Point=s},wBzb:function(t,e,r){"use strict";t.exports=function(t,e,r){var o=t*e,i=n*t,a=i-(i-t),s=t-a,u=n*e,p=u-(u-e),l=e-p,c=s*l-(o-a*p-s*p-a*l);if(r)return r[0]=c,r[1]=o,r;return[c,o]};var n=+(Math.pow(2,27)+1)},yiNX:function(t,e,r){"use strict";t.exports=function(t){var e=t.length;if(e<3){for(var r=new Array(e),o=0;o<e;++o)r[o]=o;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:r}for(var i=new Array(e),o=0;o<e;++o)i[o]=o;i.sort(function(e,r){var n=t[e][0]-t[r][0];return n||t[e][1]-t[r][1]});for(var a=[i[0],i[1]],s=[i[0],i[1]],o=2;o<e;++o){for(var u=i[o],p=t[u],l=a.length;l>1&&n(t[a[l-2]],t[a[l-1]],p)<=0;)l-=1,a.pop();for(a.push(u),l=s.length;l>1&&n(t[s[l-2]],t[s[l-1]],p)>=0;)l-=1,s.pop();s.push(u)}for(var r=new Array(s.length+a.length-2),c=0,o=0,h=a.length;o<h;++o)r[c++]=a[o];for(var f=s.length-2;f>0;--f)r[c++]=s[f];return r};var n=r("krrK")[3]},zMfC:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r){this.pmap=t,this.id=e,this.source=r}return t.prototype.getId=function(){return this.id},t.prototype.getType=function(){return this.source.type},t.prototype.getUrl=function(){switch(this.getType()){case"vector":case"raster":case"raster-dem":return this.getUrlEx();default:return""}},t.prototype.setData=function(t){if("geojson"!=this.getType())throw new Error("The setData function only supports data sources of type geojson");this.source.data=t,this.pmap.getSource(this.id).setData(t)},t.prototype.getUrlEx=function(){if(this.source.url)return this.source.url;var t=this.source.tiles,e="";return"string"==typeof t?e=t:t instanceof Array&&(e=t.join()),e},t}();e.MbSource=n}})});